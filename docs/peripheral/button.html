<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-peripheral/button" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Button Driver | TuyaOpen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tuyaopen.io/img/home/tuyaopen-logo-social-preview.png"><meta data-rh="true" name="twitter:image" content="https://tuyaopen.io/img/home/tuyaopen-logo-social-preview.png"><meta data-rh="true" property="og:url" content="https://tuyaopen.io/docs/peripheral/button"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Button Driver | TuyaOpen"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tuyaopen.io/docs/peripheral/button"><link data-rh="true" rel="alternate" href="https://tuyaopen.io/docs/peripheral/button" hreflang="en"><link data-rh="true" rel="alternate" href="https://tuyaopen.io/zh/docs/peripheral/button" hreflang="zh"><link data-rh="true" rel="alternate" href="https://tuyaopen.io/docs/peripheral/button" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NT1L7IWROF-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Button Driver","item":"https://tuyaopen.io/docs/peripheral/button"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TuyaOpen RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TuyaOpen Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3M0J54E8XF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3M0J54E8XF",{})</script>



<link rel="search" type="application/opensearchdescription+xml" title="TuyaOpen" href="/opensearch.xml">

<link rel="preconnect" href="https://www.clarity.ms">
<script>!function(t,e,n,c,r,s,a){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(s=e.createElement(c)).async=1,s.src="https://www.clarity.ms/tag/lggqck9srz",(a=e.getElementsByTagName(c)[0]).parentNode.insertBefore(s,a)}(window,document,"clarity","script")</script>


<meta name="algolia-site-verification" content="6232065417750C16"><link rel="stylesheet" href="/assets/css/styles.f74361a4.css">
<script src="/assets/js/runtime~main.4200f71d.js" defer="defer"></script>
<script src="/assets/js/main.bb4294a2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div class="announcement-bar" style="background-color:#0598ea;color:#ffffff"><div class="announcement-content"><span>üèÜ Join the TuyaOpen AI Hardware Contest! 100 days to build the future of AI devices</span><a class="announcement-link" style="color:#ffffff" href="/blog/8-8-online-contest">Learn More ‚Üí</a><button class="announcement-close" aria-label="[object Object]" style="color:#ffffff">√ó</button></div></div><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/home/tuyaopen-logo-simple-dark.png" alt="TuyaOpen" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/home/tuyaopen-logo-simple-light.png" alt="TuyaOpen" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TuyaOpen</b></a><a class="navbar__item navbar__link" href="/docs/about-tuyaopen">Documentation</a><a class="navbar__item navbar__link" href="/pricing">Service</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Tools</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tools/tyutool">Universal Serial Port Tools</a></li><li><a href="https://tuyaopen.ai/tools" target="_blank" rel="noopener noreferrer" class="dropdown__link">Web Serial/Flashing Tools<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/peripheral/button" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh/docs/peripheral/button" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">ÁÆÄ‰Ωì‰∏≠Êñá</a></li></ul></div><a href="https://github.com/tuya/TuyaOpen" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/home/tuyaopen-logo-simple-dark.png" alt="TuyaOpen" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/home/tuyaopen-logo-simple-light.png" alt="TuyaOpen" class="themedComponent_mlkZ themedComponent--dark_xIcU"><b>TuyaOpen</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/about-tuyaopen">About TuyaOpen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/project-walkthrough">Directory Structure</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/quick-start">Getting Started</a><button aria-label="Collapse sidebar category &#x27;Getting Started&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/unboxing">Unboxing Use</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/enviroment-setup">Set up Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/project-compilation">Build Project</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/firmware-burning">Firmware Burning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/equipment-authorization">Equipment Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/device-network-configuration">Device Network Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start/device-debug">Device Debugging</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/hardware-specific">Hardware Guides</a><button aria-label="Collapse sidebar category &#x27;Hardware Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/docs/hardware-specific/t5-ai-board/overview-t5-ai-board">T5-AI Board DevKit</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/hardware-specific/t5-ai-board/overview-t5-ai-board">Overview T5-AI Devkit</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/applications">Applications</a><button aria-label="Expand sidebar category &#x27;Applications&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/examples/demo-generic-examples">Examples</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/peripheral/support_peripheral_list">Peripherals</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/peripheral/support_peripheral_list">Peripheral Driver List</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/peripheral/display">Display Driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/peripheral/audio">Audio Driver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/peripheral/button">Button Driver</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/new-hardware/new-platform">New Project</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tkl-api/tkl_mutex">TKL APIs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tos-tools/tos-guide">Tos Tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/build-system/compilation-guide">Build System</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/faqs">FAQs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/contribute/contribute-guide">Contribute</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Peripherals</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Button Driver</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Button Driver</h1></header>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">‚Äã</a></h2>
<p>The <a href="https://github.com/tuya/TuyaOpen/tree/master/src/peripherals/button" target="_blank" rel="noopener noreferrer">Button Driver</a> is a core component in TuyaOpen for handling user input. It provides a unified interface to manage different types of button devices and supports various button event detection and handling mechanisms. With this driver, applications can easily implement button input detection, event handling, and state management without worrying about the specific implementation details of the underlying hardware.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="prerequisite-concepts">Prerequisite Concepts<a href="#prerequisite-concepts" class="hash-link" aria-label="Direct link to Prerequisite Concepts" title="Direct link to Prerequisite Concepts">‚Äã</a></h2>
<table><thead><tr><th>Term</th><th style="text-align:left">Explanation</th></tr></thead><tbody><tr><td>GPIO</td><td style="text-align:left">General Purpose Input/Output pin, used to connect external devices such as buttons</td></tr><tr><td>Debounce</td><td style="text-align:left">Buttons produce mechanical bouncing when pressed or released, which needs to be eliminated by software or hardware</td></tr><tr><td>Pull-up/Pull-down</td><td style="text-align:left">The level configuration of a GPIO pin, used to determine the default state when the button is not pressed</td></tr><tr><td>Interrupt</td><td style="text-align:left">An asynchronous notification mechanism triggered by a hardware event, which can achieve low-power button detection</td></tr><tr><td>Polling</td><td style="text-align:left">A detection method that periodically checks the button status, suitable for simple application scenarios</td></tr><tr><td>Active Level</td><td style="text-align:left">The level state of the GPIO pin when the button is pressed, which can be configured to be active high or active low</td></tr><tr><td>Edge Trigger</td><td style="text-align:left">The interrupt trigger mode, which can be configured as rising edge, falling edge, or dual edge trigger</td></tr><tr><td>State Machine</td><td style="text-align:left">A logical control mechanism used to manage button event detection and handling</td></tr></tbody></table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-connection-framework">Button Connection Framework<a href="#button-connection-framework" class="hash-link" aria-label="Direct link to Button Connection Framework" title="Direct link to Button Connection Framework">‚Äã</a></h2>
<p>Depending on the hardware design, the button connection method will also be different. Common connection methods include pull-up buttons and pull-down buttons.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pull-up-button-connection-framework">Pull-up Button Connection Framework<a href="#pull-up-button-connection-framework" class="hash-link" aria-label="Direct link to Pull-up Button Connection Framework" title="Direct link to Pull-up Button Connection Framework">‚Äã</a></h3>
<p></p><figure><img decoding="async" loading="lazy" alt="pullup button" src="/assets/images/pullup_button-4cbcc774ca127a8cf24a924f858a040f.png" width="613" height="318" class="img_ev3q"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">pullup button</figcaption></figure><p></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pull-down-button-connection-framework">Pull-down Button Connection Framework<a href="#pull-down-button-connection-framework" class="hash-link" aria-label="Direct link to Pull-down Button Connection Framework" title="Direct link to Pull-down Button Connection Framework">‚Äã</a></h3>
<p></p><figure><img decoding="async" loading="lazy" alt="pulldown button" src="/assets/images/pulldown_button-eb365852610ea5c6194b6dd1fecd8bfa.png" width="587" height="331" class="img_ev3q"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">pulldown button</figcaption></figure><p></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="functional-modules">Functional Modules<a href="#functional-modules" class="hash-link" aria-label="Direct link to Functional Modules" title="Direct link to Functional Modules">‚Äã</a></h2>
<p>TuyaOpen aims to provide a standardized, platform-independent button solution with a core design philosophy of layered decoupling. It separates the application layer&#x27;s button requirements from the underlying specific hardware implementation.</p>
<ul>
<li><strong>For Application Developers</strong>: Regardless of which chip&#x27;s GPIO is used at the bottom layer, the application layer only needs to call a unified, standardized set of APIs (the tdl_button_xxx series of functions), such as tdl_button_create, tdl_button_event_register, etc. This greatly reduces the complexity of application development and improves code portability.</li>
<li><strong>For Driver Developers</strong>: When a new hardware platform needs to be supported, you only need to follow the standard interface defined in <code>tdl_button_driver.h</code>, write a new TDD layer driver (similar to <code>tdd_button_gpio.c</code>), and then register it with the TDL management layer, without modifying any application layer code.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="abstract-management-module-tdl-tuya-driver-layer">Abstract Management Module: TDL (Tuya Driver Layer)<a href="#abstract-management-module-tdl-tuya-driver-layer" class="hash-link" aria-label="Direct link to Abstract Management Module: TDL (Tuya Driver Layer)" title="Direct link to Abstract Management Module: TDL (Tuya Driver Layer)">‚Äã</a></h3>
<p>This is the highest level of abstraction, providing a unified button service interface to the application layer.</p>
<ul>
<li>tdl_button_manage.c/h: Implements the management core of the button driver. It maintains a linked list to register and manage different types (or different platforms) of button device drivers. Applications use button functions by calling tdl_button_create, tdl_button_event_register, etc., without worrying about the underlying implementation.</li>
<li>tdl_button_driver.h: Defines the &quot;standardized interface&quot; (TDL_BUTTON_CTRL_INFO) that all button device drivers must comply with, including function pointers such as button_create, button_delete, read_value. This ensures that tdl_button_manage can uniformly call any underlying driver that conforms to this standard.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="instantiation-and-registration-module-tdd-tuya-device-driver">Instantiation and Registration Module: TDD (Tuya Device Driver)<a href="#instantiation-and-registration-module-tdd-tuya-device-driver" class="hash-link" aria-label="Direct link to Instantiation and Registration Module: TDD (Tuya Device Driver)" title="Direct link to Instantiation and Registration Module: TDD (Tuya Device Driver)">‚Äã</a></h3>
<p>This is the middle layer of the driver, which is the specific implementation of a particular hardware platform.</p>
<ul>
<li>tdd_button_gpio.c/h: The driver implementation for GPIO buttons. It is responsible for connecting the upper and lower layers, implementing the TDL_BUTTON_CTRL_INFO standard interface defined by TDL upwards, and calling the GPIO interface of the TKL layer downwards to control the real hardware. The tdd_gpio_button_register function will register the implementation of this driver (function pointers) to the TDL layer.</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="feature-introduction">Feature Introduction<a href="#feature-introduction" class="hash-link" aria-label="Direct link to Feature Introduction" title="Direct link to Feature Introduction">‚Äã</a></h2>
<p><strong>a. Button Event Detection</strong></p>
<ul>
<li>Multiple Event Types: Supports multiple button events such as press, release, single click, double click, multiple clicks, long press start, and long press hold.</li>
<li>Asynchronous Event Callback: The driver uses a callback mechanism (TDL_BUTTON_EVENT_CB) to push detected button events to the application layer in real time. The application layer does not need to actively poll the button status, but passively receives event notifications, which is more efficient.</li>
<li>State Machine Handling: An internal state machine is used to manage the various state transitions of the button, ensuring the accuracy and reliability of event detection.</li>
</ul>
<p><strong>b. Button Scanning Mode</strong></p>
<ul>
<li>Timed Scan Mode: Periodically checks the button status through a timer, suitable for application scenarios that are not demanding on power consumption.</li>
<li>Interrupt Scan Mode: Uses the GPIO interrupt mechanism to detect changes in button status, achieving low-power button detection, suitable for battery-powered devices.</li>
</ul>
<p><strong>c. Debounce Handling</strong></p>
<ul>
<li>Software Debounce: Effectively eliminates false triggers caused by mechanical button bounce through configurable debounce time parameters.</li>
<li>Flexible Configuration: The debounce time can be personalized according to the characteristics of different buttons.</li>
</ul>
<p><strong>d. Long Press Function</strong></p>
<ul>
<li>Configurable Long Press Detection: Supports configuring the long press start time and the long press hold trigger interval.</li>
<li>Long Press Event Separation: Distinguishes between long press start events and long press hold events to meet different application requirements.</li>
</ul>
<p><strong>e. Multi-click Detection</strong></p>
<ul>
<li>Double/Multi-click Support: Supports double-click and multi-click event detection, and can configure the effective number of clicks and the time window for multi-clicks.</li>
<li>Flexible Time Configuration: The effective time interval for multi-click events can be configured.</li>
</ul>
<p><strong>f. Extensible Driver Management</strong></p>
<ul>
<li>Dynamic Registration and Discovery: The system can register multiple different button drivers at the same time.</li>
<li>Find by Name: The application layer can find and obtain a handle to a specific button device through a string name, achieving flexible device selection.</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="supported-peripherals-list">Supported Peripherals List<a href="#supported-peripherals-list" class="hash-link" aria-label="Direct link to Supported Peripherals List" title="Direct link to Supported Peripherals List">‚Äã</a></h2>
<table><thead><tr><th style="text-align:center">Button Type</th><th style="text-align:center">Polling Scan</th><th style="text-align:center">Interrupt Scan</th></tr></thead><tbody><tr><td style="text-align:center">GPIO Button</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr><tr><td style="text-align:center">Matrix Keyboard</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr><tr><td style="text-align:center">Capacitive Touch Button</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚ùå</td></tr><tr><td style="text-align:center">ADC Button</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚ùå</td></tr></tbody></table>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="workflow">Workflow<a href="#workflow" class="hash-link" aria-label="Direct link to Workflow" title="Direct link to Workflow">‚Äã</a></h2>
<p>Taking the GPIO button as an example, this section introduces the workflow of the button driver framework.</p>
<!-- -->
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="development-guide">Development Guide<a href="#development-guide" class="hash-link" aria-label="Direct link to Development Guide" title="Direct link to Development Guide">‚Äã</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="kconfig-configuration">Kconfig Configuration<a href="#kconfig-configuration" class="hash-link" aria-label="Direct link to Kconfig Configuration" title="Direct link to Kconfig Configuration">‚Äã</a></h3>
<p>If you want to add the driver to the compilation, you need to check whether the relevant Kconfig options are enabled before compiling. In the target project path, execute <code>tos.py config menu</code> in the terminal to view the following configuration options.</p>
<table><thead><tr><th style="text-align:left">Configuration Macro</th><th style="text-align:left">Type</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">enable button</td><td style="text-align:left">Boolean</td><td style="text-align:left">The driver code will only be compiled if this macro is enabled.</td></tr><tr><td style="text-align:left">the num of button</td><td style="text-align:left">Integer</td><td style="text-align:left">Configure the number of buttons.</td></tr><tr><td style="text-align:left">the name of button 1</td><td style="text-align:left">String</td><td style="text-align:left">Configure the device name of the first button.</td></tr><tr><td style="text-align:left">the name of button 2</td><td style="text-align:left">String</td><td style="text-align:left">Configure the device name of the second button.</td></tr><tr><td style="text-align:left">the name of button 3</td><td style="text-align:left">String</td><td style="text-align:left">Configure the device name of the third button.</td></tr><tr><td style="text-align:left">the name of button 4</td><td style="text-align:left">String</td><td style="text-align:left">Configure the device name of the fourth button.</td></tr></tbody></table>
<p></p><figure><img decoding="async" loading="lazy" alt="open_button" src="/assets/images/open_button-f2c4ae39df595a374801c435074d8c4a.png" width="566" height="240" class="img_ev3q"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">open_button</figcaption></figure><p></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>The above configuration items must be supported in <code>src/peripherals/button/Kconfig</code> and <code>boards/&lt;target_platform&gt;/&lt;target_board&gt;/Kconfig</code> (select your target development board to view the Kconfig file). If you do not find the relevant configuration items, please check the contents of these two files.</p></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="runtime-environment">Runtime Environment<a href="#runtime-environment" class="hash-link" aria-label="Direct link to Runtime Environment" title="Direct link to Runtime Environment">‚Äã</a></h3>
<p>If you want to run this driver, you need to first enable the <strong>main enable macro</strong> <code>&lt;ENABLE_BUTTON&gt;</code>. There are three ways to enable this macro: <strong>Board default enabled</strong>, <strong>enabled a feature that requires the button driver</strong>, and <strong>manually enabled</strong>.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>All the following commands need to be executed in the target application directory. Do not execute them directly in the TuyaOpen root directory or other directories, otherwise an error will be reported.</p></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="target-board-default-enabled">Target Board Default Enabled<a href="#target-board-default-enabled" class="hash-link" aria-label="Direct link to Target Board Default Enabled" title="Direct link to Target Board Default Enabled">‚Äã</a></h4>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>In this case, the development board selected by the developer has usually already registered the button device. At this time, the source file in the target Board has already written the registration code.</p><p>For example, the TUYA_T5AI_BOARD development board supports user buttons. When adapting this board, the button device has already been registered, and the boards/T5AI/TUYA_T5AI_BOARD/Kconfig file will also have <code>select ENABLE_BUTTON</code> written.</p></div></div>
<p>That is, as long as the developer selects the corresponding target Board, the driver will be automatically enabled.</p>
<ul>
<li>
<p>Execute the command to enter the Kconfig menu</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tos.py config menu</span><br></span></code></pre></div></div>
</li>
</ul>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>After executing <code>select ENABLE_XXX</code> in <code>boards/&lt;platform&gt;/&lt;target_board&gt;/Kconfig</code>, you cannot manually select/deselect it by executing <code>tos.py config menu</code>.</p></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="enabled-a-feature-that-requires-the-button-driver">Enabled a feature that requires the button driver<a href="#enabled-a-feature-that-requires-the-button-driver" class="hash-link" aria-label="Direct link to Enabled a feature that requires the button driver" title="Direct link to Enabled a feature that requires the button driver">‚Äã</a></h4>
<p>If the developer selects a feature that depends on the button driver, the enable macro for the button driver will also be automatically enabled.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="manually-enable-the-macro">Manually enable the macro<a href="#manually-enable-the-macro" class="hash-link" aria-label="Direct link to Manually enable the macro" title="Direct link to Manually enable the macro">‚Äã</a></h4>
<ul>
<li>
<p>Execute the command to enter the Kconfig menu</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tos.py config menu</span><br></span></code></pre></div></div>
</li>
<li>
<p>Enable the driver enable macro</p>
</li>
</ul>
<p></p><figure><img decoding="async" loading="lazy" alt="open button" src="/assets/images/open_button-f2c4ae39df595a374801c435074d8c4a.png" width="566" height="240" class="img_ev3q"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">open button</figcaption></figure><p></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="how-to-use">How to Use<a href="#how-to-use" class="hash-link" aria-label="Direct link to How to Use" title="Direct link to How to Use">‚Äã</a></h3>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="adapting-the-button-driver">Adapting the Button Driver<a href="#adapting-the-button-driver" class="hash-link" aria-label="Direct link to Adapting the Button Driver" title="Direct link to Adapting the Button Driver">‚Äã</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If the developer finds a corresponding driver in the existing button drivers, this step can be ignored. If a suitable button driver is not found, the driver can be adapted by yourself.</p></div></div>
<ol>
<li>Create <code>tdd_button_xxx.c/h</code> files in <code>src/peripherals/button/tdd_button</code>.</li>
<li><strong>Allocate memory</strong> for the device and adapt the abstract interface of the button driver (function pointers such as button_create, button_delete, read_value, etc.) according to your device.</li>
<li>Call the <strong>register common button device node</strong> interface (tdl_button_register()).</li>
<li>For example code, please refer to the already adapted GPIO button driver.</li>
</ol>
<p>For specific examples, please refer to <code>examples/peripherals/button</code>.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="registering-the-button-device">Registering the Button Device<a href="#registering-the-button-device" class="hash-link" aria-label="Direct link to Registering the Button Device" title="Direct link to Registering the Button Device">‚Äã</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If the target Board selected by the developer has already registered the button device, you only need to select the target board in Kconfig and call the <code>board_register_hardware()</code> interface in the application. This interface has already registered the corresponding button device.</p></div></div>
<ol>
<li>Write the registration interface according to the developer&#x27;s button model and connection pins. It is recommended to write it in <code>board_register_hardware()</code>, the implementation path of this interface is <code>boards/&lt;target_platform&gt;/&lt;target_board&gt;/xxx.c</code>.</li>
<li>Configure the basic information of the device and call the registration interface in <code>board_register_hardware()</code>.</li>
</ol>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">__board_register_button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* Write your struct configuration information here */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* begin */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/* end */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">TUYA_CALL_ERR_RETURN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">tdd_gpio_button_register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BUTTON_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">button_cfg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> OPRT_OK</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">board_register_hardware</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">TUYA_CALL_ERR_LOG</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">__board_register_button</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> OPRT_OK</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="controlling-the-device">Controlling the Device<a href="#controlling-the-device" class="hash-link" aria-label="Direct link to Controlling the Device" title="Direct link to Controlling the Device">‚Äã</a></h4>
<p>Control the button device according to the tdl layer interface provided in <code>src/peripherals/button/tdl_button/include/tdl_button_manage.h</code>.</p>
<ul>
<li>Create a button device instance and configure parameters</li>
<li>Register a button event callback function</li>
<li>Handle button events</li>
<li>Delete the button device instance</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="development-process">Development Process<a href="#development-process" class="hash-link" aria-label="Direct link to Development Process" title="Direct link to Development Process">‚Äã</a></h2>
<p>The user can complete the development of the button peripheral with just a few simple APIs.</p>
<!-- -->
<p>The example for the button is in the <code>examples/peripherals/button</code> path. Developers can modify it based on the provided example.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="api-reference">API Reference<a href="#api-reference" class="hash-link" aria-label="Direct link to API Reference" title="Direct link to API Reference">‚Äã</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-device-configuration-structure">Button Device Configuration Structure<a href="#button-device-configuration-structure" class="hash-link" aria-label="Direct link to Button Device Configuration Structure" title="Direct link to Button Device Configuration Structure">‚Äã</a></h3>
<p>Taking the GPIO button as an example, construct the TDD layer hardware configuration information structure.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief GPIO button configuration structure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This structure contains all hardware configuration parameters for GPIO button,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * including pin number, operation mode, active level, and pin type settings.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TUYA_GPIO_NUM_E pin</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// GPIO pin number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TUYA_GPIO_LEVEL_E level</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Active level (HIGH/LOW)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDD_GPIO_TYPE_U pin_type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// Pin configuration (pull-up/pull-down for scan mode, edge type for IRQ mode)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_MODE_E mode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Button operation mode (timer scan or interrupt)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> BUTTON_GPIO_CFG_T</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">union</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TUYA_GPIO_MODE_E gpio_pull</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// GPIO pull mode for BUTTON_TIMER_SCAN_MODE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TUYA_GPIO_IRQ_E irq_edge</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// IRQ edge type for BUTTON_IRQ_MODE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> TDD_GPIO_TYPE_U</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-software-configuration-structure">Button Software Configuration Structure<a href="#button-software-configuration-structure" class="hash-link" aria-label="Direct link to Button Software Configuration Structure" title="Direct link to Button Software Configuration Structure">‚Äã</a></h3>
<p>Used to configure the software parameters of the button, including debounce time, long press time, etc.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Button software configuration structure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This structure contains software configuration parameters for button behavior,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * including debounce time, long press timing, and multi-click settings.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> long_start_valid_time</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Long press start valid time (ms)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> long_keep_timer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// Long press hold trigger interval (ms)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> button_debounce_time</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Button debounce time (ms)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> button_repeat_valid_count</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Multi-click count threshold</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> button_repeat_valid_time</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Multi-click valid time window (ms)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> TDL_BUTTON_CFG_T</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-event-enumeration">Button Event Enumeration<a href="#button-event-enumeration" class="hash-link" aria-label="Direct link to Button Event Enumeration" title="Direct link to Button Event Enumeration">‚Äã</a></h3>
<p>Defines all event types supported by the button.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Button event types enumeration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This enumeration defines all supported button event types that can be</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * detected and reported to the application layer.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_PRESS_DOWN </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic">// Press down trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_PRESS_UP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// Release trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_PRESS_SINGLE_CLICK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Single click trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_PRESS_DOUBLE_CLICK</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Double click trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_PRESS_REPEAT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Multiple click trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_LONG_PRESS_START</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// Long press start trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_LONG_PRESS_HOLD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Long press hold trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_RECOVER_PRESS_UP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// Recovery press up trigger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_PRESS_MAX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// Maximum event count</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    TDL_BUTTON_PRESS_NONE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// No event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> TDL_BUTTON_TOUCH_EVENT_E</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-driver-registration-structure">Button Driver Registration Structure<a href="#button-driver-registration-structure" class="hash-link" aria-label="Direct link to Button Driver Registration Structure" title="Direct link to Button Driver Registration Structure">‚Äã</a></h3>
<p>To register the button driver structure, developers need to implement the corresponding function pointers according to their own button driver.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Button driver interface structure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This structure contains function pointers for all button operations, providing</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * a unified interface for the button abstract layer to call driver functions.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">OPERATE_RET</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">button_create</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TDL_BUTTON_OPRT_INFO </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">dev</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">OPERATE_RET</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">button_delete</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TDL_BUTTON_OPRT_INFO </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">dev</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">OPERATE_RET</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">read_value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TDL_BUTTON_OPRT_INFO </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">dev</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">uint8_t</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> TDL_BUTTON_CTRL_INFO</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-device-registration-interface">Button Device Registration Interface<a href="#button-device-registration-interface" class="hash-link" aria-label="Direct link to Button Device Registration Interface" title="Direct link to Button Device Registration Interface">‚Äã</a></h3>
<p>This interface is used to register the button device driver with the system and is the entry point of the button driver framework. By passing in the device name and configuration parameters, the button device is added to the management list for use by the application.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Registers a GPIO button device driver with the button management system.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function registers a GPIO button device driver including device name and </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * hardware configuration parameters. After successful registration, applications </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * can create button instances and use the button device by name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param name Button device name used for identification and lookup</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param gpio_cfg GPIO button configuration parameters including pin number, </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> *                 operation mode, active level, and pin type settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful registration, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdd_gpio_button_register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> BUTTON_GPIO_CFG_T </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">gpio_cfg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-driver-registration-interface">Button Driver Registration Interface<a href="#button-driver-registration-interface" class="hash-link" aria-label="Direct link to Button Driver Registration Interface" title="Direct link to Button Driver Registration Interface">‚Äã</a></h3>
<p>This interface registers the underlying button driver interface with the abstraction layer management system, creates device nodes, and maintains the device list.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Registers button device driver interfaces to the abstract layer management system.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function registers button device driver interface functions to the button abstract </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * layer management system, creates device nodes and adds them to the device management list </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * for upper layer application calls.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param name Button device name</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param button_ctrl_info Button driver interface structure containing various operation function pointers</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param button_cfg_info Button device configuration information</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful registration, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdl_button_register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TDL_BUTTON_CTRL_INFO </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">button_ctrl_info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                TDL_BUTTON_DEVICE_INFO_T </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">button_cfg_info</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device-creation-interface">Device Creation Interface<a href="#device-creation-interface" class="hash-link" aria-label="Direct link to Device Creation Interface" title="Direct link to Device Creation Interface">‚Äã</a></h3>
<p>This interface creates a button device instance and configures software parameters to make the device available.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Creates a button device instance with specified configuration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function creates a button device instance based on the registered button driver,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * configures software parameters such as debounce time and long press timing, and </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * initializes the button hardware. After successful creation, the device enters a usable state.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param name Button device name (must match registered name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param button_cfg Button software configuration parameters</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param handle Pointer to store the returned button device handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful creation, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdl_button_create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">char</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TDL_BUTTON_CFG_T </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">button_cfg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TDL_BUTTON_HANDLE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">handle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="device-deletion-interface">Device Deletion Interface<a href="#device-deletion-interface" class="hash-link" aria-label="Direct link to Device Deletion Interface" title="Direct link to Device Deletion Interface">‚Äã</a></h3>
<p>This interface deletes a button device instance and releases related resources, including de-initializing the hardware and disabling pins.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Deletes a button device instance and releases related resources.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function deletes the specified button device instance, deinitializes button hardware </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * including disabling GPIO interrupts, releasing GPIO resources, and removing the device </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * from the management list. After deletion, the device becomes unavailable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param handle Button device handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful deletion, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdl_button_delete</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TDL_BUTTON_HANDLE handle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="event-callback-registration-interface">Event Callback Registration Interface<a href="#event-callback-registration-interface" class="hash-link" aria-label="Direct link to Event Callback Registration Interface" title="Direct link to Event Callback Registration Interface">‚Äã</a></h3>
<p>This interface is used to register a button event callback function. When the corresponding event is detected, the registered callback function will be called.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Registers an event callback function for a specific button event.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function registers a callback function for a specific button event type. When the </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * specified event is detected, the registered callback function will be called with event </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * information and parameters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param handle Button device handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param event Button event type to register callback for</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param cb Callback function pointer to be called when event occurs</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return None</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tdl_button_event_register</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TDL_BUTTON_HANDLE handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TDL_BUTTON_TOUCH_EVENT_E event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TDL_BUTTON_EVENT_CB cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-status-read-interface">Button Status Read Interface<a href="#button-status-read-interface" class="hash-link" aria-label="Direct link to Button Status Read Interface" title="Direct link to Button Status Read Interface">‚Äã</a></h3>
<p>This interface is used to read the current status of the button.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Reads the current status of a button device.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function reads the current physical status of the specified button device,</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * returning whether the button is currently pressed or released.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param handle Button device handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param status Pointer to store the button status (0: released, 1: pressed)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful reading, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdl_button_read_status</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TDL_BUTTON_HANDLE handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">uint8_t</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">status</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="button-level-setting-interface">Button Level Setting Interface<a href="#button-level-setting-interface" class="hash-link" aria-label="Direct link to Button Level Setting Interface" title="Direct link to Button Level Setting Interface">‚Äã</a></h3>
<p>This interface is used to dynamically set the active level of the button, suitable for applications such as DIP switches.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Sets the active level of a button device.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function dynamically sets the active level of the specified button device.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This is useful for toggle switches where the effective level needs to be changed</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * during runtime.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param handle Button device handle</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param level Active level to set (TUYA_GPIO_LEVEL_HIGH or TUYA_GPIO_LEVEL_LOW)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful setting, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdl_button_set_level</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TDL_BUTTON_HANDLE handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> TUYA_GPIO_LEVEL_E level</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="scan-time-configuration-interface">Scan Time Configuration Interface<a href="#scan-time-configuration-interface" class="hash-link" aria-label="Direct link to Scan Time Configuration Interface" title="Direct link to Scan Time Configuration Interface">‚Äã</a></h3>
<p>This interface is used to configure the button scan time interval.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Sets the button scan time interval.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function sets the time interval for button scanning. The default scan time</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * is 10ms. Shorter intervals provide better responsiveness but consume more CPU resources.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param time_ms Button scan time interval in milliseconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful setting, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdl_button_set_scan_time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">uint8_t</span><span class="token plain"> time_ms</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="deep-sleep-control-interface">Deep Sleep Control Interface<a href="#deep-sleep-control-interface" class="hash-link" aria-label="Direct link to Deep Sleep Control Interface" title="Direct link to Deep Sleep Control Interface">‚Äã</a></h3>
<p>This interface is used to control the enabling and disabling of the button function, suitable for low-power application scenarios.</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @brief Controls button functionality for deep sleep scenarios.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * This function enables or disables button functionality, which is useful for </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * power management in battery-powered devices. When disabled, button scanning</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * and event detection are suspended to save power.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @param enable Enable flag (0: disable, 1: enable)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * @return Returns OPRT_OK on successful control, or an appropriate error code on failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OPERATE_RET </span><span class="token function" style="color:#d73a49">tdl_button_deep_sleep_ctrl</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">uint8_t</span><span class="token plain"> enable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="precautions">Precautions<a href="#precautions" class="hash-link" aria-label="Direct link to Precautions" title="Direct link to Precautions">‚Äã</a></h2>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="hardware-configuration-precautions">Hardware Configuration Precautions<a href="#hardware-configuration-precautions" class="hash-link" aria-label="Direct link to Hardware Configuration Precautions" title="Direct link to Hardware Configuration Precautions">‚Äã</a></h3>
<ul>
<li><strong>Pin Selection</strong>: Ensure that the selected GPIO pin supports the required functions (input, pull-up/pull-down, interrupt, etc.)</li>
<li><strong>Level Configuration</strong>: Correctly configure the active level of the button to be consistent with the hardware circuit design</li>
<li><strong>Pull-up/Pull-down Configuration</strong>: Correctly configure the internal pull-up or pull-down resistor according to the button connection method</li>
<li><strong>Interrupt Edge</strong>: In interrupt mode, the interrupt trigger edge needs to be correctly configured according to the active level</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="software-configuration-precautions">Software Configuration Precautions<a href="#software-configuration-precautions" class="hash-link" aria-label="Direct link to Software Configuration Precautions" title="Direct link to Software Configuration Precautions">‚Äã</a></h3>
<ul>
<li><strong>Debounce Time Setting</strong>: The recommended range is 20-50ms. Too short may cause false triggers, and too long will affect the response speed</li>
<li><strong>Long Press Time Configuration</strong>: Reasonably set the long press start time and hold interval according to user experience requirements</li>
<li><strong>Multi-click Time Window</strong>: The time window for double/multi-clicks should conform to user operating habits, usually 300-800 ms</li>
<li><strong>Scan Time Interval</strong>: The default of 10ms is suitable for most scenarios and can be adjusted according to actual needs</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="power-consumption-optimization-suggestions">Power Consumption Optimization Suggestions<a href="#power-consumption-optimization-suggestions" class="hash-link" aria-label="Direct link to Power Consumption Optimization Suggestions" title="Direct link to Power Consumption Optimization Suggestions">‚Äã</a></h3>
<ul>
<li><strong>Interrupt Mode Priority</strong>: It is recommended to use interrupt mode instead of polling scan in low-power scenarios</li>
<li><strong>Deep Sleep Control</strong>: Turn off the button function in time when it is not needed to save power</li>
<li><strong>Scan Frequency Optimization</strong>: Appropriately increasing the scan interval can reduce power consumption, but it will affect the response speed</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="thread-safety-precautions">Thread Safety Precautions<a href="#thread-safety-precautions" class="hash-link" aria-label="Direct link to Thread Safety Precautions" title="Direct link to Thread Safety Precautions">‚Äã</a></h3>
<ul>
<li><strong>Callback Function Restrictions</strong>: Avoid performing time-consuming operations in the callback function, which may affect the detection of other buttons</li>
<li><strong>Resource Competition</strong>: When multiple buttons share a scan task, pay attention to avoiding resource competition issues</li>
<li><strong>Interrupt Context</strong>: The callback function in interrupt mode runs in the interrupt context, and interrupt safety needs to be paid attention to</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="debugging-suggestions">Debugging Suggestions<a href="#debugging-suggestions" class="hash-link" aria-label="Direct link to Debugging Suggestions" title="Direct link to Debugging Suggestions">‚Äã</a></h3>
<ul>
<li><strong>Log Output</strong>: Enabling button-related debugging logs is helpful for problem location</li>
<li><strong>Status Monitoring</strong>: You can monitor the real-time status of the button through the <code>tdl_button_read_status</code> interface</li>
<li><strong>Event Statistics</strong>: Add event counting in the callback function to facilitate verification of whether the button function is normal</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="common-problem-solving">Common Problem Solving<a href="#common-problem-solving" class="hash-link" aria-label="Direct link to Common Problem Solving" title="Direct link to Common Problem Solving">‚Äã</a></h3>
<ul>
<li><strong>Button No Response</strong>: Check whether the GPIO configuration, active level setting, and driver registration are correct</li>
<li><strong>Frequent False Triggers</strong>: Appropriately increase the debounce time and check whether there is interference in the hardware circuit</li>
<li><strong>Long Press Not Triggered</strong>: Check whether the long press time configuration is reasonable and confirm that the hardware connection is stable</li>
<li><strong>Double Click Recognition Failure</strong>: Adjust the double-click time window to ensure that the user operation is within the effective time</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Tuya-Community/TuyaOpen.io/edit/master/docs/peripheral/button.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/peripheral/audio"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Audio Driver</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/new-hardware/new-platform"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Create platform</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#prerequisite-concepts" class="table-of-contents__link toc-highlight">Prerequisite Concepts</a></li><li><a href="#button-connection-framework" class="table-of-contents__link toc-highlight">Button Connection Framework</a><ul><li><a href="#pull-up-button-connection-framework" class="table-of-contents__link toc-highlight">Pull-up Button Connection Framework</a></li><li><a href="#pull-down-button-connection-framework" class="table-of-contents__link toc-highlight">Pull-down Button Connection Framework</a></li></ul></li><li><a href="#functional-modules" class="table-of-contents__link toc-highlight">Functional Modules</a><ul><li><a href="#abstract-management-module-tdl-tuya-driver-layer" class="table-of-contents__link toc-highlight">Abstract Management Module: TDL (Tuya Driver Layer)</a></li><li><a href="#instantiation-and-registration-module-tdd-tuya-device-driver" class="table-of-contents__link toc-highlight">Instantiation and Registration Module: TDD (Tuya Device Driver)</a></li></ul></li><li><a href="#feature-introduction" class="table-of-contents__link toc-highlight">Feature Introduction</a></li><li><a href="#supported-peripherals-list" class="table-of-contents__link toc-highlight">Supported Peripherals List</a></li><li><a href="#workflow" class="table-of-contents__link toc-highlight">Workflow</a></li><li><a href="#development-guide" class="table-of-contents__link toc-highlight">Development Guide</a><ul><li><a href="#kconfig-configuration" class="table-of-contents__link toc-highlight">Kconfig Configuration</a></li><li><a href="#runtime-environment" class="table-of-contents__link toc-highlight">Runtime Environment</a></li><li><a href="#how-to-use" class="table-of-contents__link toc-highlight">How to Use</a></li></ul></li><li><a href="#development-process" class="table-of-contents__link toc-highlight">Development Process</a></li><li><a href="#api-reference" class="table-of-contents__link toc-highlight">API Reference</a><ul><li><a href="#button-device-configuration-structure" class="table-of-contents__link toc-highlight">Button Device Configuration Structure</a></li><li><a href="#button-software-configuration-structure" class="table-of-contents__link toc-highlight">Button Software Configuration Structure</a></li><li><a href="#button-event-enumeration" class="table-of-contents__link toc-highlight">Button Event Enumeration</a></li><li><a href="#button-driver-registration-structure" class="table-of-contents__link toc-highlight">Button Driver Registration Structure</a></li><li><a href="#button-device-registration-interface" class="table-of-contents__link toc-highlight">Button Device Registration Interface</a></li><li><a href="#button-driver-registration-interface" class="table-of-contents__link toc-highlight">Button Driver Registration Interface</a></li><li><a href="#device-creation-interface" class="table-of-contents__link toc-highlight">Device Creation Interface</a></li><li><a href="#device-deletion-interface" class="table-of-contents__link toc-highlight">Device Deletion Interface</a></li><li><a href="#event-callback-registration-interface" class="table-of-contents__link toc-highlight">Event Callback Registration Interface</a></li><li><a href="#button-status-read-interface" class="table-of-contents__link toc-highlight">Button Status Read Interface</a></li><li><a href="#button-level-setting-interface" class="table-of-contents__link toc-highlight">Button Level Setting Interface</a></li><li><a href="#scan-time-configuration-interface" class="table-of-contents__link toc-highlight">Scan Time Configuration Interface</a></li><li><a href="#deep-sleep-control-interface" class="table-of-contents__link toc-highlight">Deep Sleep Control Interface</a></li></ul></li><li><a href="#precautions" class="table-of-contents__link toc-highlight">Precautions</a><ul><li><a href="#hardware-configuration-precautions" class="table-of-contents__link toc-highlight">Hardware Configuration Precautions</a></li><li><a href="#software-configuration-precautions" class="table-of-contents__link toc-highlight">Software Configuration Precautions</a></li><li><a href="#power-consumption-optimization-suggestions" class="table-of-contents__link toc-highlight">Power Consumption Optimization Suggestions</a></li><li><a href="#thread-safety-precautions" class="table-of-contents__link toc-highlight">Thread Safety Precautions</a></li><li><a href="#debugging-suggestions" class="table-of-contents__link toc-highlight">Debugging Suggestions</a></li><li><a href="#common-problem-solving" class="table-of-contents__link toc-highlight">Common Problem Solving</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/quick-start/unboxing">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/pricing">Service</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/hardware-specific">Hardware List</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/hardware-specific/t5-ai-board/overview-t5-ai-board">Tuya T5AI Dev Kit</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://tuyaopen.ai/tools" target="_blank" rel="noopener noreferrer" class="footer__link-item">Web Serial Tool<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/cbGrBjx7" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/tuyasmart" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@tuya2023" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/tuya-smart" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/tuya/TuyaOpen" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://gitee.com/tuya-open/TuyaOpen" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee(Mirror)<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Acknowledgements</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://storyset.com/technology" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks for the technology illustrations by Storyset<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <p style="font-weight: 500;">Copyright ¬© TuyaOpen Authors 2025 | Documentation Distributed under Apache License Version 2.0</p>
      </div></div></div></footer></div>
</body>
</html>