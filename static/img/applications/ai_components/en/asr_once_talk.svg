<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1302px" preserveAspectRatio="none" style="width:1533px;height:1302px;background:#FFFFFF;" version="1.1" viewBox="0 0 1533 1302" width="1533px" zoomAndPan="magnify"><defs><filter height="300%" id="f1sa86r5ieh0s9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1sa86r5ieh0s9)" height="103.5313" style="stroke:#000000;stroke-width:2.0;" width="522.5" x="10" y="84.2969"/><rect fill="#FFFFFF" filter="url(#f1sa86r5ieh0s9)" height="61.3984" style="stroke:#000000;stroke-width:2.0;" width="431" x="440.5" y="244.9609"/><rect fill="#FFFFFF" filter="url(#f1sa86r5ieh0s9)" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="1435" x="10" y="405.625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="46" x2="46" y1="67.2969" y2="1233.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="486.5" x2="486.5" y1="67.2969" y2="1233.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="819.5" x2="819.5" y1="67.2969" y2="1233.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1179" x2="1179" y1="67.2969" y2="1233.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1405" x2="1405" y1="67.2969" y2="1233.9453"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1483" x2="1483" y1="67.2969" y2="1233.9453"/><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="49" x="20" y="32"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="27" y="51.9951">input</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="49" x="20" y="1232.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="27" y="1252.9404">input</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="450.5" y="63.9951">recording</text><path d="M468.5,15 C468.5,5 486.5,5 486.5,5 C486.5,5 504.5,5 504.5,15 L504.5,41 C504.5,51 486.5,51 486.5,51 C486.5,51 468.5,51 468.5,41 L468.5,15 " fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" style="stroke:#000000;stroke-width:1.5;"/><path d="M468.5,15 C468.5,25 486.5,25 486.5,25 C486.5,25 504.5,25 504.5,15 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="450.5" y="1245.9404">recording</text><path d="M468.5,1259.2422 C468.5,1249.2422 486.5,1249.2422 486.5,1249.2422 C486.5,1249.2422 504.5,1249.2422 504.5,1259.2422 L504.5,1285.2422 C504.5,1295.2422 486.5,1295.2422 486.5,1295.2422 C486.5,1295.2422 468.5,1295.2422 468.5,1285.2422 L468.5,1259.2422 " fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" style="stroke:#000000;stroke-width:1.5;"/><path d="M468.5,1259.2422 C468.5,1269.2422 486.5,1269.2422 486.5,1269.2422 C486.5,1269.2422 504.5,1269.2422 504.5,1259.2422 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="80" x="777.5" y="32"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="784.5" y="51.9951">cloud_asr</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="80" x="777.5" y="1232.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="784.5" y="1252.9404">cloud_asr</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="47" x="1154" y="32"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1161" y="51.9951">main</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="47" x="1154" y="1232.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="1161" y="1252.9404">main</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="1376" y="32"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="1383" y="51.9951">player</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="55" x="1376" y="1232.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="1383" y="1252.9404">player</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="72" x="1445" y="32"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="1452" y="51.9951">ai_agent</text><rect fill="#FEFECE" filter="url(#f1sa86r5ieh0s9)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="72" x="1445" y="1232.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="1452" y="1252.9404">ai_agent</text><path d="M10,84.2969 L87,84.2969 L87,91.2969 L77,101.2969 L10,101.2969 L10,84.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="103.5313" style="stroke:#000000;stroke-width:2.0;" width="522.5" x="10" y="84.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="25" y="97.3638">loop</text><polygon fill="#A80036" points="474.5,133.6953,484.5,137.6953,474.5,141.6953,478.5,137.6953" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.5" x2="480.5" y1="137.6953" y2="137.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351" x="53.5" y="117.4966">Continuously record and save the collected audio data,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="53.5" y="132.6294">write once every ~10ms</text><line style="stroke:#A80036;stroke-width:1.0;" x1="46.5" x2="88.5" y1="166.8281" y2="166.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="88.5" x2="88.5" y1="166.8281" y2="179.8281"/><line style="stroke:#A80036;stroke-width:1.0;" x1="47.5" x2="88.5" y1="179.8281" y2="179.8281"/><polygon fill="#A80036" points="57.5,175.8281,47.5,179.8281,57.5,183.8281,53.5,179.8281" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325" x="53.5" y="161.7622">Perform VAD detection on the collected audio data</text><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="215.3945"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="215.3945" y2="215.3945"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="218.3945" y2="218.3945"/><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="209" x="658.5" y="204.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="190" x="664.5" y="220.895">No human voice detected</text><path d="M440.5,244.9609 L517.5,244.9609 L517.5,251.9609 L507.5,261.9609 L440.5,261.9609 L440.5,244.9609 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="61.3984" style="stroke:#000000;stroke-width:2.0;" width="431" x="440.5" y="244.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="455.5" y="258.0278">loop</text><polygon fill="#A80036" points="497.5,294.3594,487.5,298.3594,497.5,302.3594,493.5,298.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="491.5" x2="818.5" y1="298.3594" y2="298.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="309" x="503.5" y="278.1606">Only save the most recent 600ms of audio data,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="503.5" y="293.2935">for cloud VAD usage</text><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="333.9258"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="333.9258" y2="333.9258"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="336.9258" y2="336.9258"/><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="186" x="670" y="323.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="167" x="676" y="339.4263">Human voice detected</text><line style="stroke:#A80036;stroke-width:1.0;" x1="46.5" x2="88.5" y1="377.625" y2="377.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="88.5" x2="88.5" y1="377.625" y2="390.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="47.5" x2="88.5" y1="390.625" y2="390.625"/><polygon fill="#A80036" points="57.5,386.625,47.5,390.625,57.5,394.625,53.5,390.625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426" x="53.5" y="372.5591">Perform local ASR wake word detection on the collected audio data</text><path d="M10,405.625 L74,405.625 L74,412.625 L64,422.625 L10,422.625 L10,405.625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="117.5313" style="stroke:#000000;stroke-width:2.0;" width="1435" x="10" y="405.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="418.6919">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="143" x="89" y="417.8354">[Wake word detected]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="46.5" x2="88.5" y1="443.8906" y2="443.8906"/><line style="stroke:#A80036;stroke-width:1.0;" x1="88.5" x2="88.5" y1="443.8906" y2="456.8906"/><line style="stroke:#A80036;stroke-width:1.0;" x1="47.5" x2="88.5" y1="456.8906" y2="456.8906"/><polygon fill="#A80036" points="57.5,452.8906,47.5,456.8906,57.5,460.8906,53.5,456.8906" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="53.5" y="438.8247">Enter valid audio detection state</text><polygon fill="#A80036" points="1167.5,482.0234,1177.5,486.0234,1167.5,490.0234,1171.5,486.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46.5" x2="1173.5" y1="486.0234" y2="486.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="53.5" y="480.9575">Notify that wake word is detected</text><polygon fill="#A80036" points="1393.5,511.1563,1403.5,515.1563,1393.5,519.1563,1397.5,515.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1179.5" x2="1399.5" y1="515.1563" y2="515.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="1186.5" y="510.0903">Play prompt sound</text><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="550.7227"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="550.7227" y2="550.7227"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="553.7227" y2="553.7227"/><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="546" x="490" y="540.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="527" x="496" y="556.2231">No human voice detected within 30 seconds after wake word detected</text><line style="stroke:#A80036;stroke-width:1.0;" x1="46.5" x2="88.5" y1="594.4219" y2="594.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="88.5" x2="88.5" y1="594.4219" y2="607.4219"/><line style="stroke:#A80036;stroke-width:1.0;" x1="47.5" x2="88.5" y1="607.4219" y2="607.4219"/><polygon fill="#A80036" points="57.5,603.4219,47.5,607.4219,57.5,611.4219,53.5,607.4219" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="53.5" y="589.356">Return to wake word detection state</text><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="635.9883"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="635.9883" y2="635.9883"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="638.9883" y2="638.9883"/><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="435" x="545.5" y="625.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="416" x="551.5" y="641.4888">After wake word detected, human voice detected again</text><polygon fill="#A80036" points="1167.5,675.6875,1177.5,679.6875,1167.5,683.6875,1171.5,679.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46.5" x2="1173.5" y1="679.6875" y2="679.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="53.5" y="674.6216">Valid audio data detected</text><polygon fill="#A80036" points="830.5,704.8203,820.5,708.8203,830.5,712.8203,826.5,708.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="824.5" x2="1178.5" y1="708.8203" y2="708.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="836.5" y="703.7544">Start reporting task</text><polygon fill="#A80036" points="1471,733.9531,1481,737.9531,1471,741.9531,1475,737.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="819.5" x2="1477" y1="737.9531" y2="737.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="826.5" y="732.8872">Start reporting</text><polygon fill="#A80036" points="497.5,763.0859,487.5,767.0859,497.5,771.0859,493.5,767.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="491.5" x2="818.5" y1="767.0859" y2="767.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="503.5" y="762.02">Read audio data</text><polygon fill="#A80036" points="1471,792.2188,1481,796.2188,1471,800.2188,1475,796.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="819.5" x2="1477" y1="796.2188" y2="796.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="826.5" y="791.1528">Report audio data stream</text><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="824.7852"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="824.7852" y2="824.7852"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="827.7852" y2="827.7852"/><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="237" x="644.5" y="814.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="218" x="650.5" y="830.2856">End of human voice detected</text><polygon fill="#A80036" points="1167.5,864.4844,1177.5,868.4844,1167.5,872.4844,1171.5,868.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="46.5" x2="1173.5" y1="868.4844" y2="868.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="53.5" y="863.4185">Valid audio data collection ended</text><polygon fill="#A80036" points="830.5,893.6172,820.5,897.6172,830.5,901.6172,826.5,897.6172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="824.5" x2="1178.5" y1="897.6172" y2="897.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="836.5" y="892.5513">End reporting task</text><polygon fill="#A80036" points="57.5,922.75,47.5,926.75,57.5,930.75,53.5,926.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="51.5" x2="1178.5" y1="926.75" y2="926.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="63.5" y="921.6841">Return to wake word detection state</text><polygon fill="#A80036" points="497.5,951.8828,487.5,955.8828,497.5,959.8828,493.5,955.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="491.5" x2="818.5" y1="955.8828" y2="955.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="503.5" y="950.8169">Read remaining cached audio data</text><polygon fill="#A80036" points="1471,981.0156,1481,985.0156,1471,989.0156,1475,985.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="819.5" x2="1477" y1="985.0156" y2="985.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="826.5" y="979.9497">Report audio data stream</text><polygon fill="#A80036" points="1471,1010.1484,1481,1014.1484,1471,1018.1484,1475,1014.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="819.5" x2="1477" y1="1014.1484" y2="1014.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="826.5" y="1009.0825">End audio stream reporting</text><line style="stroke:#A80036;stroke-width:1.0;" x1="819.5" x2="861.5" y1="1043.2813" y2="1043.2813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="861.5" x2="861.5" y1="1043.2813" y2="1056.2813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="820.5" x2="861.5" y1="1056.2813" y2="1056.2813"/><polygon fill="#A80036" points="830.5,1052.2813,820.5,1056.2813,830.5,1060.2813,826.5,1056.2813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="826.5" y="1038.2153">Wait for cloud ASR</text><polygon fill="#A80036" points="1190.5,1081.4141,1180.5,1085.4141,1190.5,1089.4141,1186.5,1085.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1184.5" x2="1482" y1="1085.4141" y2="1085.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="1196.5" y="1080.3481">Return text after ASR</text><polygon fill="#A80036" points="830.5,1110.5469,820.5,1114.5469,830.5,1118.5469,826.5,1114.5469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="824.5" x2="1178.5" y1="1114.5469" y2="1114.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336" x="836.5" y="1109.481">ASR result received, reporting state can become idle</text><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1526" x="0" y="1143.1133"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="1143.1133" y2="1143.1133"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1526" y1="1146.1133" y2="1146.1133"/><rect fill="#EEEEEE" filter="url(#f1sa86r5ieh0s9)" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="261" x="632.5" y="1132.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="242" x="638.5" y="1148.6138">Cloud sends AI reply information</text><polygon fill="#A80036" points="1190.5,1182.8125,1180.5,1186.8125,1190.5,1190.8125,1186.5,1186.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1184.5" x2="1482" y1="1186.8125" y2="1186.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="1196.5" y="1181.7466">Notify text and audio information</text><polygon fill="#A80036" points="1393.5,1211.9453,1403.5,1215.9453,1393.5,1219.9453,1397.5,1215.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1179.5" x2="1399.5" y1="1215.9453" y2="1215.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="1186.5" y="1210.8794">Play audio data sent from cloud</text><!--MD5=[f9965913309b15c28711b002fcbb5cca]
@startuml
participant input 
database recording
loop
input - -> recording: Continuously record and save the collected audio data,\nwrite once every ~10ms
input -> input: Perform VAD detection on the collected audio data
end
== No human voice detected ==
loop
cloud_asr - -> recording: Only save the most recent 600ms of audio data,\nfor cloud VAD usage
end
== Human voice detected ==
input -> input: Perform local ASR wake word detection on the collected audio data
alt Wake word detected
input -> input: Enter valid audio detection state
input -> main: Notify that wake word is detected
main -> player: Play prompt sound
end
== No human voice detected within 30 seconds after wake word detected ==
input-> input: Return to wake word detection state
== After wake word detected, human voice detected again ==
input -> main: Valid audio data detected
main -> cloud_asr: Start reporting task
cloud_asr -> ai_agent: Start reporting
cloud_asr - -> recording: Read audio data
cloud_asr -> ai_agent: Report audio data stream
== End of human voice detected ==
input -> main: Valid audio data collection ended
main -> cloud_asr: End reporting task
main -> input: Return to wake word detection state
cloud_asr- -> recording: Read remaining cached audio data
cloud_asr -> ai_agent: Report audio data stream
cloud_asr -> ai_agent: End audio stream reporting
cloud_asr -> cloud_asr: Wait for cloud ASR
ai_agent -> main: Return text after ASR
main -> cloud_asr: ASR result received, reporting state can become idle
== Cloud sends AI reply information ==
ai_agent -> main: Notify text and audio information
main -> player: Play audio data sent from cloud
@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>