"use strict";(self.webpackChunktuyaopen_io_website=self.webpackChunktuyaopen_io_website||[]).push([["2593"],{50815:function(n,e,l){l.r(e),l.d(e,{frontMatter:()=>s,toc:()=>c,default:()=>A,metadata:()=>t,assets:()=>d,contentTitle:()=>r});var t=JSON.parse('{"id":"tkl-api/tkl_uart","title":"tkl_uart | UART \u9A71\u52A8","description":"\u7B80\u8981\u8BF4\u660E","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/tkl-api/tkl_uart.md","sourceDirName":"tkl-api","slug":"/tkl-api/tkl_uart","permalink":"/zh/docs/tkl-api/tkl_uart","draft":false,"unlisted":false,"editUrl":"https://github.com/Tuya-Community/TuyaOpen.io/edit/master/i18n/zh/docusaurus-plugin-content-docs/current/tkl-api/tkl_uart.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"tkl_spi | SPI \u9A71\u52A8","permalink":"/zh/docs/tkl-api/tkl_spi"},"next":{"title":"tkl_wifi | Wi-Fi \u9A71\u52A8","permalink":"/zh/docs/tkl-api/tkl_wifi"}}'),i=l(74848),_=l(84429);let s={},r="tkl_uart | UART \u9A71\u52A8",d={},c=[{value:"\u7B80\u8981\u8BF4\u660E",id:"\u7B80\u8981\u8BF4\u660E",level:2},{value:"API \u63CF\u8FF0",id:"api-\u63CF\u8FF0",level:2},{value:"tkl_uart_init",id:"tkl_uart_init",level:3},{value:"TUYA_UART_PARITY_TYPE_E:",id:"tuya_uart_parity_type_e",level:4},{value:"TUYA_UART_DATA_LEN_E:",id:"tuya_uart_data_len_e",level:4},{value:"TUYA_UART_STOP_LEN_E:",id:"tuya_uart_stop_len_e",level:4},{value:"TUYA_UART_FLOWCTRL_TYPE_E:",id:"tuya_uart_flowctrl_type_e",level:4},{value:"tkl_uart_deinit:",id:"tkl_uart_deinit",level:3},{value:"tkl_uart_write:",id:"tkl_uart_write",level:3},{value:"tkl_uart_rx_irq_cb_reg:",id:"tkl_uart_rx_irq_cb_reg",level:3},{value:"tkl_uart_tx_irq_cb_reg:",id:"tkl_uart_tx_irq_cb_reg",level:3},{value:"tkl_uart_read:",id:"tkl_uart_read",level:3},{value:"tkl_uart_set_tx_int:",id:"tkl_uart_set_tx_int",level:3},{value:"tkl_uart_set_rx_flowctrl:",id:"tkl_uart_set_rx_flowctrl",level:3},{value:"tkl_uart_wait_for_data\uFF1A",id:"tkl_uart_wait_for_data",level:3},{value:"tkl_uart_ioctl\uFF1A",id:"tkl_uart_ioctl",level:3},{value:"TUYA_UART_IOCTL_CMD_E\uFF1A",id:"tuya_uart_ioctl_cmd_e",level:4},{value:"1.uart \u793A\u4F8B\u4E00",id:"1uart-\u793A\u4F8B\u4E00",level:2},{value:"2.uart \u793A\u4F8B\u4E8C",id:"2uart-\u793A\u4F8B\u4E8C",level:2}];function x(n){let e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,_.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"tkl_uart--uart-\u9A71\u52A8",children:"tkl_uart | UART \u9A71\u52A8"})}),"\n",(0,i.jsx)(e.h2,{id:"\u7B80\u8981\u8BF4\u660E",children:"\u7B80\u8981\u8BF4\u660E"}),"\n",(0,i.jsx)(e.p,{children:"UART(Universal Asynchronous Receiver/Transmitter) \u662F\u4E00\u79CD\u901A\u7528\u4E32\u884C\u6570\u636E\u603B\u7EBF\uFF0C\u7528\u4E8E\u5F02\u6B65\u901A\u4FE1\u3002\u8BE5\u603B\u7EBF\u53CC\u5411\u901A\u4FE1\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u5168\u53CC\u5DE5\u4F20\u8F93\u548C\u63A5\u6536\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"api-\u63CF\u8FF0",children:"API \u63CF\u8FF0"}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_init",children:"tkl_uart_init"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"OPERATE_RET tkl_uart_init(TUYA_UART_NUM_E port_id, TUYA_UART_BASE_CFG_T *cfg);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u901A\u8FC7\u7AEF\u53E3\u53F7\u548C\u57FA\u7840\u914D\u7F6E\u521D\u59CB\u5316\u5BF9\u5E94\u7684 UART \u5B9E\u4F8B\uFF0C\u8FD4\u56DE\u521D\u59CB\u5316\u7ED3\u679C \u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"port_id"}),": \u7AEF\u53E3\u53F7\u3002"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"cfg"}),": UART \u57FA\u7840\u914D\u7F6E\uFF0C\u5305\u542B\u6CE2\u7279\u7387\uFF0C\u5947\u5076\u6821\u9A8C\u4F4D\uFF0C\u505C\u6B62\u4F4D\uFF0C\u6D41\u63A7\u5236"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef struct {\n    uint32_t                    baudrate;\n    TUYA_UART_PARITY_TYPE_E     parity;\n    TUYA_UART_DATA_LEN_E        databits;\n    TUYA_UART_STOP_LEN_E        stopbits;\n    TUYA_UART_FLOWCTRL_TYPE_E   flowctrl;\n} TUYA_UART_BASE_CFG_T;\n"})}),"\n",(0,i.jsx)(e.h4,{id:"tuya_uart_parity_type_e",children:"TUYA_UART_PARITY_TYPE_E:"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u540D\u5B57"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5B9A\u4E49"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5907\u6CE8"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_PARITY_TYPE_NONE"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x0 (\u6CA1\u6709\u6821\u9A8C\u4F4D)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_PARITY_TYPE_ODD"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x1 (\u5947\u6570\u6821\u9A8C\u4F4D)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_PARITY_TYPE_EVEN"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x2 (\u5076\u6570\u6821\u9A8C\u4F4D)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,i.jsx)(e.h4,{id:"tuya_uart_data_len_e",children:"TUYA_UART_DATA_LEN_E:"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u540D\u5B57"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5B9A\u4E49"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5907\u6CE8"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_5BIT"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x5 (5\u4F4D\u6570\u636E\u957F\u5EA6)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_6BIT"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x6 (6\u4F4D\u6570\u636E\u957F\u5EA6)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_7BIT"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x7 (7\u4F4D\u6570\u636E\u957F\u5EA6)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_DATA_LEN_8BIT"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x8 (8\u4F4D\u6570\u636E\u957F\u5EA6)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,i.jsx)(e.h4,{id:"tuya_uart_stop_len_e",children:"TUYA_UART_STOP_LEN_E:"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u540D\u5B57"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5B9A\u4E49"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5907\u6CE8"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_STOP_LEN_1BIT"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x1 (1\u4F4D\u505C\u6B62\u4F4D)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_STOP_LEN_1_5BIT1"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x2 (1.5\u4F4D\u505C\u6B62\u4F4D)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_STOP_LEN_2BIT"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x3 (2\u4F4D\u505C\u6B62\u4F4D)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,i.jsx)(e.h4,{id:"tuya_uart_flowctrl_type_e",children:"TUYA_UART_FLOWCTRL_TYPE_E:"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u540D\u5B57"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5B9A\u4E49"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5907\u6CE8"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_NONE"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x0 (\u6CA1\u6709\u8FDB\u884C\u6D41\u63A7\u5236)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_RTSCTS"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x1 (\u8BF7\u6C42/\u6E05\u9664\u53D1\u9001)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_XONXOFF"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x2 (\u6682\u505C\u4F20\u8F93/\u56DE\u590D\u4F20\u8F93)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_FLOWCTRL_DTRDSR"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x3 (\u6570\u636E\u7EC8\u7AEF\u51C6\u5907\u597D/\u6570\u636E\u51C6\u5907\u597D)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["OPRT_OK \u6210\u529F\uFF0C\u5176\u4ED6\u8BF7\u53C2\u8003\u6587\u4EF6 ",(0,i.jsx)(e.code,{children:"tuya_error_code.h"}),"\uFF0Cuart type \u5B9A\u4E49\u90E8\u5206\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_deinit",children:"tkl_uart_deinit:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"OPERATE_RET tkl_uart_deinit(TUYA_UART_NUM_E port_id);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"UART \u53CD\u521D\u59CB\u5316\u3002\u8BE5\u63A5\u53E3\u4F1A\u505C\u6B62 UART\u3002"}),"\n",(0,i.jsx)(e.li,{children:"\u7ED3\u675F\u6B63\u5728\u8FDB\u884C\u7684\u4F20\u8F93\uFF08\u5982\u679C\u6709\uFF09\uFF0C\u5E76\u4E14\u91CA\u653E\u76F8\u5173\u7684\u8F6F\u786C\u4EF6\u8D44\u6E90\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"port_id"}),": \u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["OPRT_OK \u6210\u529F\uFF0C\u5176\u4ED6\u8BF7\u53C2\u8003\u6587\u4EF6 ",(0,i.jsx)(e.code,{children:"tuya_error_code.h"}),"\uFF0Cuart type \u5B9A\u4E49\u90E8\u5206\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_write",children:"tkl_uart_write:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"int tkl_uart_write(TUYA_UART_NUM_E port_id, void *buff, uint16_t len);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"UART \u53D1\u9001\u6570\u636E\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"part_id"}),": \u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"buff"}),": \u53D1\u9001\u6570\u636E\u7F13\u51B2\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"len"}),": \u53D1\u9001\u6570\u636E\u957F\u5EA6\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:">=0"})," \u53D1\u9001\u6570\u636E\u957F\u5EA6\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"< 0 "})," \u53D1\u9001\u6570\u636E\u9519\u8BEF\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_rx_irq_cb_reg",children:"tkl_uart_rx_irq_cb_reg:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"void tkl_uart_rx_irq_cb_reg(TUYA_UART_NUM_E port_id, TUYA_UART_IRQ_CB rx_cb);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6CE8\u518C UART \u63A5\u53D7\u4E2D\u65AD\u56DE\u8C03\u51FD\u6570\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"part_id"}),": \u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"rx_cb"}),": \u63A5\u53D7\u4E2D\u65AD\u56DE\u8C03\u51FD\u6570\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:["\u56DE\u8C03\u51FD\u6570\u7C7B\u578B ",(0,i.jsx)(e.code,{children:"TUYA_UART_IRQ_CB"})," \u5B9A\u4E49\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef void (*TUYA_UART_IRQ_CB)(TUYA_UART_NUM_E port_id);\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5176\u4E2D ",(0,i.jsx)(e.code,{children:"port_id"})," \u4E3A\u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"void"}),": \u7A7A"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_tx_irq_cb_reg",children:"tkl_uart_tx_irq_cb_reg:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"void tkl_uart_tx_irq_cb_reg(TUYA_UART_NUM_E port_id, TUYA_UART_IRQ_CB tx_cb);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6CE8\u518C UART \u63A5\u53D7\u4E2D\u65AD\u56DE\u8C03\u51FD\u6570\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"part_id"}),": \u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"tx_cb"}),": \u53D1\u9001\u4E2D\u65AD\u56DE\u8C03\u51FD\u6570\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u56DE\u8C03\u51FD\u6570\u7C7B\u578B ",(0,i.jsx)(e.code,{children:"TUYA_UART_IRQ_CB"})," \u5B9A\u4E49\u5982\u4E0B\uFF1A"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef void (*TUYA_UART_IRQ_CB)(TUYA_UART_NUM_E port_id);\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u5176\u4E2D ",(0,i.jsx)(e.code,{children:"port_id"})," \u4E3A\u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"void"}),": \u7A7A"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_read",children:"tkl_uart_read:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"int tkl_uart_read(TUYA_UART_NUM_E port_id, void *buff, uint16_t len);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8BFB\u53D6uart\u4E2D\u7684\u6570\u636E\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"part_id"}),": \u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"buff"}),": \u6570\u636E\u63A5\u6536\u7F13\u51B2\u533A\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"len"}),": \u9700\u8981\u63A5\u53D7\u7684\u6570\u636E\u957F\u5EA6\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:">=0"})," \u53D1\u9001\u6570\u636E\u957F\u5EA6\u3002"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"< 0 "})," \u53D1\u9001\u6570\u636E\u9519\u8BEF\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_set_tx_int",children:"tkl_uart_set_tx_int:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"OPERATE_RET tkl_uart_set_tx_int(TUYA_UART_NUM_E port_id, BOOL_T enable);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"enabe/disable uart \u53D1\u9001\u4E2D\u65AD"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"port_id"}),":\u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"enable"}),":\u4E2D\u65ADenabel/disable","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"0: disable"}),"\n",(0,i.jsx)(e.li,{children:"1: enable"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["OPRT_OK \u6210\u529F\uFF0C\u5176\u4ED6\u8BF7\u53C2\u8003\u6587\u4EF6 ",(0,i.jsx)(e.code,{children:"tuya_error_code.h"}),"\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_set_rx_flowctrl",children:"tkl_uart_set_rx_flowctrl:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"OPERATE_RET tkl_uart_set_rx_flowctrl(TUYA_UART_NUM_E port_id, BOOL_T enable);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"enable/disable uart \u63A5\u53D7\u6D41\u63A7\u5236\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"port_id"}),":\u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"enable"}),": \u6D41\u63A7\u5236 enabel/disable","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"0: disable"}),"\n",(0,i.jsx)(e.li,{children:"1: enable"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["OPRT_OK \u6210\u529F\uFF0C\u5176\u4ED6\u8BF7\u53C2\u8003\u6587\u4EF6 ",(0,i.jsx)(e.code,{children:"tuya_error_code.h"}),"\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_wait_for_data",children:"tkl_uart_wait_for_data\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"OPERATE_RET tkl_uart_wait_for_data(TUYA_UART_NUM_E port_id, int timeout_ms);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7B49\u5F85\u63A5\u53D7\u6570\u636E"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"port_id"}),": \u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"timeout_ms"}),": \u7B49\u5F85\u6BEB\u79D2\u6570\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["OPRT_OK \u6210\u529F\uFF0C\u5176\u4ED6\u8BF7\u53C2\u8003\u6587\u4EF6 ",(0,i.jsx)(e.code,{children:"tuya_error_code.h"}),"\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"tkl_uart_ioctl",children:"tkl_uart_ioctl\uFF1A"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"OPERATE_RET tkl_uart_ioctl(TUYA_UART_NUM_E port_id, uint32_t cmd, void *arg);\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u529F\u80FD\u63CF\u8FF0\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"uart command control"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u53C2\u6570\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"port_id"}),":\u7AEF\u53E3\u53F7\u3002"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"typedef enum {\n    TUYA_UART_NUM_0,		    // UART 0\n    TUYA_UART_NUM_1,		    // UART 1\n    TUYA_UART_NUM_2,	        // UART 2\n    TUYA_UART_NUM_3,	        // UART 3\n    TUYA_UART_NUM_4,	        // UART 4\n    TUYA_UART_NUM_5,	        // UART 5\n    TUYA_UART_NUM_MAX,\n} TUYA_UART_NUM_E;\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"cmd"}),": UART \u63A7\u5236\u547D\u4EE4\u3002"]}),"\n",(0,i.jsx)(e.h4,{id:"tuya_uart_ioctl_cmd_e",children:"TUYA_UART_IOCTL_CMD_E\uFF1A"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u540D\u5B57"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5B9A\u4E49"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u5907\u6CE8"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_SUSPEND_CMD"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x0 (\u6682\u505C UART)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_RESUME_CMD"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x1 (\u6062\u590D UART)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_FLUSH_CMD"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x2 (\u5237\u65B0 UART \u7F13\u51B2)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_RECONFIG_CMD"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x3 (\u91CD\u65B0\u521D\u59CB\u5316 UART)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"TUYA_UART_USER_CMD"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"0x4 (\u7528\u6237\u81EA\u5B9A\u4E49\u547D\u4EE4)"}),(0,i.jsx)(e.td,{style:{textAlign:"left"}})]})]})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"arg"}),": \u5BF9\u5E94\u63A7\u5236\u547D\u4EE4\u7684\u53C2\u6570"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8FD4\u56DE\u503C\uFF1A"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["OPRT_OK \u6210\u529F\uFF0C\u5176\u4ED6\u8BF7\u53C2\u8003\u6587\u4EF6 ",(0,i.jsx)(e.code,{children:"tuya_error_code.h"}),"\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h1,{id:"\u793A\u4F8B",children:"\u793A\u4F8B"}),"\n",(0,i.jsx)(e.h2,{id:"1uart-\u793A\u4F8B\u4E00",children:"1.uart \u793A\u4F8B\u4E00"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"int uart_loopback_test(void)\n{\n    uint32_t port_id;\n    TUYA_UART_BASE_CFG_T cfg;\n    OPERATE_RET ret = OPRT_OK;\n    const int bufsize = 8;\n    unsigned char tx[bufsize], rx[bufsize];\n    int bytes;\n    int i;\n\n    // start\n    port_id = TUYA_UART_NUM_0;\n\n    cfg.baudrate = 115200;\n    cfg.databits = TUYA_UART_DATA_LEN_8BIT;\n    cfg.parity = TUYA_UART_PARITY_TYPE_NONE;\n    cfg.stopbits = TUYA_UART_STOP_LEN_1BIT;\n    cfg.flowctrl = TUYA_UART_FLOWCTRL_NONE;\n\n    ret = tkl_uart_init(port_id, &cfg);\n\n    for (i = 0; i < bufsize; i++) {\n        tx[i] = 'A' + i;\n    }\n\n    // loop 3 times\n    for(i = 0; i < 3; i ++) {\n        bzero(rx, sizeof(rx));\n\n        bytes = tkl_uart_write(port_id, tx, sizeof(tx));\n        if (bytes <= 0) {\n            // fail\n            ret = OPRT_COM_ERROR;\n         } else {\n             // wait at most 5 seconds until the data is ready\n            ret = tkl_uart_wait_for_data(port_id, 5000);\n            if (ret == OPRT_TIMEOUT) {\n               // timeout\n               tkl_uart_deinit(port_id);\n               return OPRT_COM_ERROR;\n            }\n\n            bytes = tkl_uart_read(port_id, rx, sizeof(rx));\n            if (bytes < 0) {\n                // fail\n                ret = OPRT_COM_ERROR;\n            } else {\n                if (memcmp(tx, rx, bufsize) != 0) {\n                    // data is not identical\n                    ret = OPRT_COM_ERROR;\n                } else {\n                    ret = OPRT_OK;\n                }\n            }\n        }\n\n        if (ret != OPRT_OK) {\n            // fail\n        } else {\n            // ok\n        }\n    }\n    //deinit\n    tkl_uart_deinit(port_id);\n    return ret;\n}\n\n"})}),"\n",(0,i.jsx)(e.h2,{id:"2uart-\u793A\u4F8B\u4E8C",children:"2.uart \u793A\u4F8B\u4E8C"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"static int sg_rx_flag = 0;\nstatic int sg_tx_flag = 0;\n\nstatic void tuya_rx_cb(TUYA_UART_NUM_E port_id)\n{\n    // mutex lock\n    sg_rx_flag = 1;\n    // mutex unlock\n}\n\nstatic static void tuya_tx_cb(TUYA_UART_NUM_E port_id)\n{\n    // mutex lock\n    sg_tx_flag = 1;\n    // mutex unlock\n}\n\nint uart_loopback_test(void)\n{\n    uint32_t port_id;\n    TUYA_UART_BASE_CFG_T cfg;\n    OPERATE_RET ret = OPRT_OK;\n    const int bufsize = 8;\n    unsigned char tx[bufsize], rx[bufsize];\n    int bytes;\n    static int sl_first_time =1;\n    int i;\n\n    // start\n    sg_rx_flag = 0;\n    sg_tx_flag = 0;\n\n    port_id = TUYA_UART_NUM_0;\n\n    cfg.baudrate = 115200;\n    cfg.databits = TUYA_UART_DATA_LEN_8BIT;\n    cfg.parity = TUYA_UART_PARITY_TYPE_NONE;\n    cfg.stopbits = TUYA_UART_STOP_LEN_1BIT;\n    cfg.flowctrl = TUYA_UART_FLOWCTRL_NONE;\n\n    ret = tkl_uart_init(port_id, &cfg);\n\n    if(tkl_uart_set_tx_int(port_id,1) < 0) {\n        //fail\n        tkl_uart_deinit(port_id);\n        return OPRT_COM_ERROR;\n    }\n\n    for (i = 0; i < bufsize; i++) {\n        tx[i] = 'A' + i;\n    }\n\n    // loop 3 times\n    for(i=0;i<3;i++) {\n\n        bzero(rx, sizeof(rx));\n\n\n        if(sl_first_time || sg_tx_flag) {\n            bytes = tkl_uart_write(port_id, tx, sizeof(tx));\n        }else {\n            continue;\n        }\n\n        if (bytes <= 0) {\n            // fail\n             ret = OPRT_COM_ERROR;\n        } else {\n        // wait at most 5 seconds until the data is ready\n        ret = tkl_uart_wait_for_data(port_id, 5000);\n\n        if(sg_rx_flag) {\n            bytes = tkl_uart_read(port_id, rx, sizeof(rx));\n            if (bytes < 0) {\n               // fail\n               ret = OPRT_COM_ERROR;\n            } else {\n                if (memcmp(tx, rx, bufsize) != 0) {\n                // data is not identical\n                ret = OPRT_COM_ERROR;\n                } else {\n                    ret = OPRT_OK;\n                }\n            }\n            sg_rx_flag = 0;\n           }\n        }\n        if (ret != OPRT_OK) {\n        // fail\n        } else {\n        // ok\n        }\n    }\n    // disabe int\n    tkl_uart_set_tx_int(port_id,0);\n    //deinit\n    tkl_uart_deinit(port_id);\n    return ret;\n}\n\n"})})]})}function A(n={}){let{wrapper:e}={...(0,_.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(x,{...n})}):x(n)}},84429:function(n,e,l){l.d(e,{R:()=>s,x:()=>r});var t=l(96540);let i={},_=t.createContext(i);function s(n){let e=t.useContext(_);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),t.createElement(_.Provider,{value:e},n.children)}}}]);