"use strict";(self.webpackChunktuyaopen_io_website=self.webpackChunktuyaopen_io_website||[]).push([["5337"],{63029:function(e,n,l){l.r(n),l.d(n,{frontMatter:()=>d,toc:()=>o,default:()=>t,metadata:()=>i,assets:()=>a,contentTitle:()=>r});var i=JSON.parse('{"id":"build-system/compilation-guide","title":"\u7F16\u8BD1\u6307\u5BFC","description":"\u6982\u8FF0","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/build-system/compilation-guide.md","sourceDirName":"build-system","slug":"/build-system/compilation-guide","permalink":"/zh/docs/build-system/compilation-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/Tuya-Community/TuyaOpen.io/edit/master/i18n/zh/docusaurus-plugin-content-docs/current/build-system/compilation-guide.md","tags":[],"version":"current","frontMatter":{"title":"\u7F16\u8BD1\u6307\u5BFC"},"sidebar":"docs","previous":{"title":"tyutool \u5DE5\u5177\u4ECB\u7ECD","permalink":"/zh/docs/tos-tools/tools-tyutool"},"next":{"title":"FAQs","permalink":"/zh/docs/faqs/"}}'),c=l(74848),s=l(84429);let d={title:"\u7F16\u8BD1\u6307\u5BFC"},r="TuyaOpen \u7F16\u8BD1\u6D41\u7A0B\u8BE6\u89E3",a={},o=[{value:"\u6982\u8FF0",id:"\u6982\u8FF0",level:2},{value:"\u7F16\u8BD1\u6D41\u7A0B\u67B6\u6784",id:"\u7F16\u8BD1\u6D41\u7A0B\u67B6\u6784",level:2},{value:"\u6D41\u7A0B\u8BF4\u660E",id:"\u6D41\u7A0B\u8BF4\u660E",level:2},{value:"1. Config \u547D\u4EE4\u6267\u884C (cli_config.py)",id:"1-config-\u547D\u4EE4\u6267\u884C-cli_configpy",level:3},{value:"2. Build \u547D\u4EE4\u6267\u884C (cli_build.py)",id:"2-build-\u547D\u4EE4\u6267\u884C-cli_buildpy",level:3},{value:"2.1 \u73AF\u5883\u68C0\u67E5",id:"21-\u73AF\u5883\u68C0\u67E5",level:4},{value:"2.2 \u914D\u7F6E\u521D\u59CB\u5316",id:"22-\u914D\u7F6E\u521D\u59CB\u5316",level:4},{value:"2.3 \u5E73\u53F0\u4E0B\u8F7D",id:"23-\u5E73\u53F0\u4E0B\u8F7D",level:4},{value:"2.4 \u5E73\u53F0\u51C6\u5907",id:"24-\u5E73\u53F0\u51C6\u5907",level:4},{value:"2.5 \u6784\u5EFA\u8BBE\u7F6E",id:"25-\u6784\u5EFA\u8BBE\u7F6E",level:4},{value:"2.6 CMake \u914D\u7F6E",id:"26-cmake-\u914D\u7F6E",level:4},{value:"2.7 Ninja \u6784\u5EFA",id:"27-ninja-\u6784\u5EFA",level:4},{value:"2.8 \u8F93\u51FA\u9A8C\u8BC1",id:"28-\u8F93\u51FA\u9A8C\u8BC1",level:4},{value:"3. CMake \u6784\u5EFA\u7CFB\u7EDF (CMakeLists.txt)",id:"3-cmake-\u6784\u5EFA\u7CFB\u7EDF-cmakeliststxt",level:3},{value:"3.1 Kconfig \u914D\u7F6E\u7CFB\u7EDF",id:"31-kconfig-\u914D\u7F6E\u7CFB\u7EDF",level:4},{value:"3.2 \u5DE5\u5177\u94FE\u914D\u7F6E",id:"32-\u5DE5\u5177\u94FE\u914D\u7F6E",level:4},{value:"3.3 \u7EC4\u4EF6\u7F16\u8BD1",id:"33-\u7EC4\u4EF6\u7F16\u8BD1",level:4},{value:"3.4 \u5E93\u6587\u4EF6\u751F\u6210",id:"34-\u5E93\u6587\u4EF6\u751F\u6210",level:4},{value:"3.5 \u5E94\u7528\u7F16\u8BD1",id:"35-\u5E94\u7528\u7F16\u8BD1",level:4},{value:"3.6 \u5E73\u53F0\u6784\u5EFA",id:"36-\u5E73\u53F0\u6784\u5EFA",level:4},{value:"4. \u5173\u952E\u6587\u4EF6\u548C\u76EE\u5F55\u7ED3\u6784",id:"4-\u5173\u952E\u6587\u4EF6\u548C\u76EE\u5F55\u7ED3\u6784",level:3},{value:"5. \u7F16\u8BD1\u8F93\u51FA",id:"5-\u7F16\u8BD1\u8F93\u51FA",level:3},{value:"\u603B\u7ED3",id:"\u603B\u7ED3",level:2},{value:"FAQ",id:"faq",level:2}];function h(e){let n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"tuyaopen-\u7F16\u8BD1\u6D41\u7A0B\u8BE6\u89E3",children:"TuyaOpen \u7F16\u8BD1\u6D41\u7A0B\u8BE6\u89E3"})}),"\n",(0,c.jsx)(n.h2,{id:"\u6982\u8FF0",children:"\u6982\u8FF0"}),"\n",(0,c.jsxs)(n.p,{children:["\u672C\u6587\u6863\u8BE6\u7EC6\u4ECB\u7ECD\u4E86 ",(0,c.jsx)(n.code,{children:"TuyaOpen"})," \u9879\u76EE\u7684\u7F16\u8BD1\u6D41\u7A0B\uFF0C\u4ECE\u6267\u884C ",(0,c.jsx)(n.code,{children:"tos.py build"})," \u547D\u4EE4\u5F00\u59CB\uFF0C\u5230\u6700\u7EC8\u751F\u6210\u4E8C\u8FDB\u5236\u6587\u4EF6\u7684\u5B8C\u6574\u8FC7\u7A0B"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TuyaOpen"})," \u4F7F\u7528 Python \u811A\u672C\u534F\u8C03 CMake/Ninja \u6784\u5EFA\u5DE5\u5177\uFF0C\u652F\u6301\u591A\u5E73\u53F0\u3001\u591A\u914D\u7F6E\u7684\u7F16\u8BD1"]}),"\n",(0,c.jsx)(n.h2,{id:"\u7F16\u8BD1\u6D41\u7A0B\u67B6\u6784",children:"\u7F16\u8BD1\u6D41\u7A0B\u67B6\u6784"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"tos.py build\n    \u2502\n    \u251C\u2500\u2500 \u73AF\u5883\u68C0\u67E5\n    \u251C\u2500\u2500 \u914D\u7F6E\u521D\u59CB\u5316\n    \u251C\u2500\u2500 \u5E73\u53F0\u4E0B\u8F7D\n    \u251C\u2500\u2500 \u5E73\u53F0\u51C6\u5907\n    \u251C\u2500\u2500 \u6784\u5EFA\u8BBE\u7F6E\n    \u251C\u2500\u2500 CMake \u914D\u7F6E\n    \u251C\u2500\u2500 Ninja \u6784\u5EFA\n    \u2514\u2500\u2500 \u8F93\u51FA\u9A8C\u8BC1\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u6D41\u7A0B\u8BF4\u660E",children:"\u6D41\u7A0B\u8BF4\u660E"}),"\n",(0,c.jsx)(n.h3,{id:"1-config-\u547D\u4EE4\u6267\u884C-cli_configpy",children:"1. Config \u547D\u4EE4\u6267\u884C (cli_config.py)"}),"\n",(0,c.jsxs)(n.p,{children:["\u5F53\u7528\u6237\u6267\u884C ",(0,c.jsx)(n.code,{children:"tos.py config choice"})," \u547D\u4EE4\u65F6\uFF1A"]}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u6587\u4EF6\u66FF\u6362"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4F7F\u7528\u7528\u6237\u9009\u62E9\u7684\u914D\u7F6E\u6587\u4EF6\u66FF\u6362\u9ED8\u8BA4\u7684 ",(0,c.jsx)(n.code,{children:"app_default.config"})," \u6587\u4EF6"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u751F\u6210CatalogKconfig"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5728 ",(0,c.jsx)(n.code,{children:".build/cache/"})," \u76EE\u5F55\u4E0B\u751F\u6210 ",(0,c.jsx)(n.code,{children:"CatalogKconfig"})," \u6587\u4EF6\uFF0C\u5305\u542B\u6240\u6709 Kconfig \u914D\u7F6E\u6587\u4EF6"]}),"\n",(0,c.jsxs)(n.p,{children:["\u4E3B\u8981\u5305\u542B ",(0,c.jsx)(n.code,{children:"<project>/Kconfig"})," \u3001 ",(0,c.jsx)(n.code,{children:"src/Kconfig"})," \u548C ",(0,c.jsx)(n.code,{children:"boards/Kconfig"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u751F\u6210using.config\u6587\u4EF6"})}),"\n",(0,c.jsxs)(n.p,{children:["\u6839\u636E ",(0,c.jsx)(n.code,{children:"CatalogKconfig"})," \u63D0\u4F9B\u7684\u914D\u7F6E\u9009\u9879\u4EE5\u53CA ",(0,c.jsx)(n.code,{children:"app_default.config"})," \u6587\u4EF6\u63D0\u4F9B\u7684\u914D\u7F6E\u7ED3\u679C"]}),"\n",(0,c.jsxs)(n.p,{children:["\u751F\u6210 ",(0,c.jsx)(n.code,{children:".build/cache/using.config"})," \u6587\u4EF6"]}),"\n",(0,c.jsx)(n.p,{children:"\u8BE5\u6587\u4EF6\u9664\u4E86\u5305\u542B\u6240\u6709\u7528\u6237\u9009\u62E9\u7684\u4EE3\u7801\u76F8\u5173\u914D\u7F6E\u4FE1\u606F\u5916\uFF0C\u8FD8\u6709\u4E00\u4E9B\u7F16\u8BD1\u76F8\u5173\u7684\u6570\u636E\uFF0C\u4F8B\u5982\uFF1A\u9879\u76EE\u540D\u79F0\u3001\u7248\u672C\u3001\u5E73\u53F0\u3001\u5F00\u53D1\u677F\u7B49\u4FE1\u606F"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"2-build-\u547D\u4EE4\u6267\u884C-cli_buildpy",children:"2. Build \u547D\u4EE4\u6267\u884C (cli_build.py)"}),"\n",(0,c.jsxs)(n.p,{children:["\u76F8\u5173\u903B\u8F91\u53EF\u9605\u8BFB\u6587\u4EF6\uFF1A",(0,c.jsx)(n.code,{children:"tools/cli_command/cli_build.py"})]}),"\n",(0,c.jsx)(n.h4,{id:"21-\u73AF\u5883\u68C0\u67E5",children:"2.1 \u73AF\u5883\u68C0\u67E5"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"def env_check():\n    ...\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7B49\u6548\u547D\u4EE4\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"git submodule update --init\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u786E\u4FDD\u6240\u6709\u4F9D\u8D56\u7684\u5B50\u6A21\u5757\u90FD\u5DF2\u6B63\u786E\u66F4\u65B0\u3002"}),"\n",(0,c.jsx)(n.h4,{id:"22-\u914D\u7F6E\u521D\u59CB\u5316",children:"2.2 \u914D\u7F6E\u521D\u59CB\u5316"}),"\n",(0,c.jsxs)(n.p,{children:["\u751F\u6210 ",(0,c.jsx)(n.code,{children:".build/cache/using.config"})," \u6587\u4EF6"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"init_using_config(force=False)\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7F16\u8BD1\u9700\u8981\u7684\u4E3B\u8981\u914D\u7F6E\u9879\u5305\u62EC\uFF1A"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"CONFIG_PROJECT_NAME"}),": \u9879\u76EE\u540D\u79F0"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"CONFIG_PLATFORM_CHOICE"}),": \u5E73\u53F0\u9009\u62E9"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"CONFIG_CHIP_CHOICE"}),": \u82AF\u7247\u578B\u53F7"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"CONFIG_BOARD_CHOICE"}),": \u5F00\u53D1\u677F\u578B\u53F7"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"CONFIG_FRAMEWORK_CHOICE"}),": \u6846\u67B6\u7C7B\u578B"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"23-\u5E73\u53F0\u4E0B\u8F7D",children:"2.3 \u5E73\u53F0\u4E0B\u8F7D"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"def download_platform(platform):\n    ...\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u6839\u636E\u9879\u76EE\u914D\u7F6E\u4FE1\u606F\u4EE5\u53CA ",(0,c.jsx)(n.code,{children:"platform/platform_config.yaml"})," \u6587\u4EF6\u63D0\u4F9B\u7684git\u4FE1\u606F\uFF0C\u4E0B\u8F7D\u5BF9\u5E94\u7684\u786C\u4EF6\u5E73\u53F0\u4EE3\u7801"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5E73\u53F0\u4EE3\u7801\u5B58\u653E\u5728 ",(0,c.jsx)(n.code,{children:"platform/"})," \u76EE\u5F55\u4E0B"]}),"\n",(0,c.jsx)(n.p,{children:"\u7B49\u6548\u547D\u4EE4\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"git clone <repository_url> <tuyaopen_root>/platform/<platform_name>\ncd <tuyaopen_root>/platform/<platform_name>\ngit checkout <commit_hash>\n"})}),"\n",(0,c.jsx)(n.h4,{id:"24-\u5E73\u53F0\u51C6\u5907",children:"2.4 \u5E73\u53F0\u51C6\u5907"}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679C\u5E73\u53F0\u4EE3\u7801\u4E2D\u5B58\u5728 ",(0,c.jsx)(n.code,{children:"platform_prepare.py"})," \u811A\u672C\uFF0C\u5219\u6267\u884C\u8BE5\u811A\u672C\u8FDB\u884C\u5E73\u53F0\u7279\u5B9A\u7684\u51C6\u5907\u5DE5\u4F5C\uFF1A"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'def prepare_platform(platform, chip=""):\n    ...\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u8BF7\u5728\u6B64\u811A\u672C\u4E2D\u5B8C\u6210\u6240\u9700\u8981\u7684\u7F16\u8BD1\u5DE5\u5177\u4E0B\u8F7D\uFF0C\u63A8\u8350\u5C06\u5DE5\u5177\u94FE\u4E0B\u8F7D\u5728",(0,c.jsx)(n.code,{children:"platform/tools"}),"\u76EE\u5F55\u4E0B"]}),"\n",(0,c.jsx)(n.p,{children:"\u7F16\u8BD1\u524D\u9700\u8981\u7684\u51C6\u5907\u5DE5\u4F5C\uFF0C\u4F8B\u5982\uFF1A\u914D\u7F6E\u6587\u4EF6\u7684\u66F4\u65B0\u3001\u53C2\u6570\u7684\u8BBE\u7F6E\u7B49\u7B49\uFF0C\u4E5F\u53EF\u4EE5\u5728\u6B64\u811A\u672C\u4E2D\u5B9E\u73B0"}),"\n",(0,c.jsx)(n.p,{children:"\u7B49\u6548\u547D\u4EE4\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"python <tuyaopen_root>/platform/<platform_name>/platform_prepare.py $CHIP\n"})}),"\n",(0,c.jsx)(n.h4,{id:"25-\u6784\u5EFA\u8BBE\u7F6E",children:"2.5 \u6784\u5EFA\u8BBE\u7F6E"}),"\n",(0,c.jsxs)(n.p,{children:["\u5982\u679C\u5E73\u53F0\u4EE3\u7801\u4E2D\u5B58\u5728 ",(0,c.jsx)(n.code,{children:"build_setup.py"})," \u811A\u672C\uFF0C\u5219\u6267\u884C\u8BE5\u811A\u672C\u8FDB\u884C\u6784\u5EFA\u8BBE\u7F6E\uFF1A"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:'def build_setup(platform, project_name, framework, chip=""):\n    ...\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u6B64\u811A\u672C\u7684\u4F5C\u7528\u4E0E ",(0,c.jsx)(n.code,{children:"2.4 \u5E73\u53F0\u51C6\u5907"})," \u4E2D\u63D0\u5230\u7684 ",(0,c.jsx)(n.code,{children:"platform_prepare.py"})," \u76F8\u540C\uFF0C\u6267\u884C\u65F6\u673A\u4E5F\u76F8\u540C"]}),"\n",(0,c.jsx)(n.p,{children:"\u6240\u4EE5\uFF0C\u53EA\u9700\u8981\u5B58\u5728\u5176\u4E2D\u4E4B\u4E00\u5373\u53EF"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.em,{children:"\u8BF4\u660E\uFF1A\u7531\u4E8ETuyaOpen\u53D1\u5C55\u7684\u67D0\u4E9B\u5386\u53F2\u539F\u56E0\uFF0C\u5BFC\u81F4\u4E24\u4E2A\u811A\u672C\u4F1A\u540C\u65F6\u751F\u6548"})}),"\n",(0,c.jsx)(n.p,{children:"\u7B49\u6548\u547D\u4EE4\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"python <tuyaopen_root>/platform/<platform_name>/build_setup.py $PROJ_NAME $PLATFORM $FRAMEWORK $CHIP\n"})}),"\n",(0,c.jsx)(n.h4,{id:"26-cmake-\u914D\u7F6E",children:"2.6 CMake \u914D\u7F6E"}),"\n",(0,c.jsx)(n.p,{children:"\u751F\u6210 CMake \u6784\u5EFA\u6587\u4EF6\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"def cmake_configure(using_data, verbose=False):\n    ...\n"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"TuyaOpen"})," \u4F7F\u7528 CMake \u6784\u5EFA\u7CFB\u7EDF\uFF0C\u914D\u7F6E\u6587\u4EF6\u4F4D\u4E8E ",(0,c.jsx)(n.code,{children:"<tuyaopen_root>/CMakeLists.txt"})," \u6587\u4EF6\u4E2D"]}),"\n",(0,c.jsx)(n.p,{children:"\u6784\u5EFA\u4E3B\u8981\u6B65\u9AA4\u89C1\u540E\u6587"}),"\n",(0,c.jsx)(n.p,{children:"\u7B49\u6548\u547D\u4EE4\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"mkdir <project_root>/.build\ncd <project_root>/.build\ncmake -G Ninja $CMAKE_VERBOSE $OPEN_SDK_ROOT -DTOS_PROJECT_NAME=$PROJ -DTOS_PROJECT_ROOT=$PROJECT_ROOT -DTOS_PROJECT_PLATFORM=$PROJECT_PLATFORM -DTOS_FRAMEWORK=$PROJECT_FRAMEWORK -DTOS_PROJECT_CHIP=$PROJECT_CHIP -DTOS_PROJECT_BOARD=$PROJECT_BOARD\n"})}),"\n",(0,c.jsx)(n.h4,{id:"27-ninja-\u6784\u5EFA",children:"2.7 Ninja \u6784\u5EFA"}),"\n",(0,c.jsx)(n.p,{children:"\u6267\u884C\u5B9E\u9645\u7684\u7F16\u8BD1\u8FC7\u7A0B\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"def ninja_build(build_path, verbose=False):\n    ...\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7B49\u6548\u547D\u4EE4\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"cd <project_root>/.build\nninja example\n"})}),"\n",(0,c.jsx)(n.h4,{id:"28-\u8F93\u51FA\u9A8C\u8BC1",children:"2.8 \u8F93\u51FA\u9A8C\u8BC1"}),"\n",(0,c.jsx)(n.p,{children:"\u6267\u884C\u7F16\u8BD1\u540E\uFF0C\u9A8C\u8BC1\u751F\u6210\u7684\u4E8C\u8FDB\u5236\u6587\u4EF6\u662F\u5426\u7B26\u5408\u9884\u671F\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-python",children:"def check_bin_file(using_data):\n    ...\n"})}),"\n",(0,c.jsx)(n.h3,{id:"3-cmake-\u6784\u5EFA\u7CFB\u7EDF-cmakeliststxt",children:"3. CMake \u6784\u5EFA\u7CFB\u7EDF (CMakeLists.txt)"}),"\n",(0,c.jsx)(n.p,{children:"\u4E3B CMakeLists.txt \u6587\u4EF6\u8D1F\u8D23\u6574\u4E2A\u9879\u76EE\u7684\u6784\u5EFA\u914D\u7F6E\uFF1A"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"<tuyaopen_root>/CMakeLists.txt"})}),"\n",(0,c.jsx)(n.h4,{id:"31-kconfig-\u914D\u7F6E\u7CFB\u7EDF",children:"3.1 Kconfig \u914D\u7F6E\u7CFB\u7EDF"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u4F7F\u7528 Kconfig \u7BA1\u7406\u914D\u7F6E\u9009\u9879"}),"\n",(0,c.jsxs)(n.li,{children:["\u5305\u542B ",(0,c.jsx)(n.code,{children:"using.cmake"})," \u914D\u7F6E"]}),"\n",(0,c.jsxs)(n.li,{children:["\u751F\u6210 ",(0,c.jsx)(n.code,{children:"tuya_kconfig.h"})," \u5934\u6587\u4EF6"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"32-\u5DE5\u5177\u94FE\u914D\u7F6E",children:"3.2 \u5DE5\u5177\u94FE\u914D\u7F6E"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cmake",children:'include("${PLATFORM_PATH}/toolchain_file.cmake")\n'})}),"\n",(0,c.jsx)(n.p,{children:"\u914D\u7F6E\u4EA4\u53C9\u7F16\u8BD1\u5DE5\u5177\u94FE\u7684\u5177\u4F53\u4F4D\u7F6E\uFF0C\u4EE5\u53CA\u901A\u7684\u7F16\u8BD1\u9009\u9879"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cmake",children:'include("${PLATFORM_PATH}/platform_config.cmake")\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u914D\u7F6E\u5E94\u7528\u5C42\u4F7F\u7528\u7684\u5934\u6587\u4EF6\u8DEF\u5F84\uFF0C\u6839\u636E",(0,c.jsx)(n.code,{children:"TuyaOpen"}),"\u8DE8\u5E73\u53F0\u7684\u8BBE\u8BA1\uFF0C\u5E94\u8BE5\u4EC5\u4EC5\u5305\u542B",(0,c.jsx)(n.code,{children:"tuyaos_adapter"}),"\u76F8\u5173\u7684\u5934\u6587\u4EF6\u8DEF\u5F84"]}),"\n",(0,c.jsx)(n.h4,{id:"33-\u7EC4\u4EF6\u7F16\u8BD1",children:"3.3 \u7EC4\u4EF6\u7F16\u8BD1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cmake",children:'# \u7F16\u8BD1 src/ \u76EE\u5F55\u4E0B\u7684\u6240\u6709\u7EC4\u4EF6\nlist_components(COMPONENT_LIST "${TOP_SOURCE_DIR}/src")\nforeach(comp ${COMPONENT_LIST})\n    add_subdirectory("${TOP_SOURCE_DIR}/src/${comp}")\nendforeach(comp)\n\n# \u7F16\u8BD1\u677F\u7EA7\u4EE3\u7801\nif(EXISTS "${TOP_SOURCE_DIR}/boards/${TOS_PROJECT_PLATFORM}/${TOS_PROJECT_BOARD}/CMakeLists.txt")\n    add_subdirectory("${TOP_SOURCE_DIR}/boards/${TOS_PROJECT_PLATFORM}/${TOS_PROJECT_BOARD}")\nendif()\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u6BCF\u4E2A\u7EC4\u4EF6\u53EF\u901A\u8FC7 ",(0,c.jsx)(n.code,{children:"src/<component_name>/CMakeLists.txt"})," \u6587\u4EF6\u8FDB\u884C\u7F16\u8BD1\u914D\u7F6E"]}),"\n",(0,c.jsxs)(n.p,{children:["\u677F\u7EA7\u4EE3\u7801\u901A\u8FC7 ",(0,c.jsx)(n.code,{children:"boards/<platform>/<board>/CMakeLists.txt"})," \u6587\u4EF6\u8FDB\u884C\u7F16\u8BD1\u914D\u7F6E"]}),"\n",(0,c.jsxs)(n.p,{children:["\u4EA7\u7269\uFF1A",(0,c.jsx)(n.code,{children:"lib<component_name>.a"})]}),"\n",(0,c.jsx)(n.h4,{id:"34-\u5E93\u6587\u4EF6\u751F\u6210",children:"3.4 \u5E93\u6587\u4EF6\u751F\u6210"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cmake",children:"# \u751F\u6210 tuyaos \u9759\u6001\u5E93\uFF0C\u5305\u542B\u6240\u6709\u7EC4\u4EF6\nadd_library(${COMPONENTS_ALL_LIB} STATIC ${all_need})\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u4EA7\u7269\uFF1A",(0,c.jsx)(n.code,{children:"libtuyaos.a"}),"\uFF0C\u5305\u542B\u6240\u6709\u7EC4\u4EF6\u7684\u9759\u6001\u5E93"]}),"\n",(0,c.jsx)(n.h4,{id:"35-\u5E94\u7528\u7F16\u8BD1",children:"3.5 \u5E94\u7528\u7F16\u8BD1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cmake",children:'# \u7F16\u8BD1\u5E94\u7528\u4EE3\u7801\nset(EXAMPLE_LIB "tuyaapp")\ninclude(${TOS_PROJECT_ROOT}/CMakeLists.txt)\ntarget_link_libraries(${EXAMPLE_LIB} ${COMPONENTS_ALL_LIB})\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u5E94\u7528\u4EE3\u7801\u901A\u8FC7 ",(0,c.jsx)(n.code,{children:"<project_root>/CMakeLists.txt"})," \u6587\u4EF6\u8FDB\u884C\u7F16\u8BD1\u914D\u7F6E"]}),"\n",(0,c.jsxs)(n.p,{children:["\u4EA7\u7269\uFF1A",(0,c.jsx)(n.code,{children:"libtuyaapp.a"})]}),"\n",(0,c.jsx)(n.h4,{id:"36-\u5E73\u53F0\u6784\u5EFA",children:"3.6 \u5E73\u53F0\u6784\u5EFA"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-cmake",children:'# \u8C03\u7528\u5E73\u53F0\u7279\u5B9A\u7684\u6784\u5EFA\u811A\u672C\nif(EXISTS "${TOP_SOURCE_DIR}/platform/${TOS_PROJECT_PLATFORM}/build_example.py")\n    set(BUILD_COMMAND python -u ./build_example.py)\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u7531\u4E8E ",(0,c.jsx)(n.code,{children:"TuyaOpen"})," \u652F\u6301\u591A\u5E73\u53F0\u7F16\u8BD1\uFF0C\u6240\u6709\u5404\u5E73\u53F0\u7684\u7F16\u8BD1\u903B\u8F91\u90FD\u53EF\u4EE5\u901A\u8FC7 ",(0,c.jsx)(n.code,{children:"platform/<platform_name>/build_example.py"})," \u6587\u4EF6\u8FDB\u884C\u5B9E\u73B0"]}),"\n",(0,c.jsxs)(n.p,{children:["\u811A\u672C\u7684\u4E3B\u8981\u4F5C\u7528\u53C2\u8003\uFF1A",(0,c.jsx)(n.a,{href:"/zh/docs/new-hardware/new-platform#%E7%BC%96%E8%AF%91%E5%92%8C%E9%93%BE%E6%8E%A5",children:"build_example.py"})]}),"\n",(0,c.jsx)(n.h3,{id:"4-\u5173\u952E\u6587\u4EF6\u548C\u76EE\u5F55\u7ED3\u6784",children:"4. \u5173\u952E\u6587\u4EF6\u548C\u76EE\u5F55\u7ED3\u6784"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"TuyaOpen/\n\u251C\u2500\u2500 tos.py                    # \u4E3B\u5165\u53E3\u811A\u672C\n\u251C\u2500\u2500 tools/\n\u2502   \u251C\u2500\u2500 cli_command/         # CLI \u547D\u4EE4\u5B9E\u73B0\n\u2502   \u2502   \u251C\u2500\u2500 cli_build.py     # build \u547D\u4EE4\u5B9E\u73B0\n\u2502   \u2502   \u251C\u2500\u2500 cli_config.py    # config \u547D\u4EE4\u5B9E\u73B0\n\u2502   \u2502   \u251C\u2500\u2500 util.py          # \u5DE5\u5177\u51FD\u6570\n\u2502   \u2502   \u2514\u2500\u2500 ...\n\u2502   \u251C\u2500\u2500 cmake/               # CMake \u76F8\u5173\u6587\u4EF6\n\u2502   \u2514\u2500\u2500 kconfiglib/          # Kconfig \u5DE5\u5177\n\u251C\u2500\u2500 platform/                # \u5E73\u53F0\u4EE3\u7801\u76EE\u5F55\n\u2502   \u251C\u2500\u2500 platform_config.yaml # \u5E73\u53F0\u914D\u7F6E\n\u2502   \u2514\u2500\u2500 [platform_name]/     # \u5177\u4F53\u5E73\u53F0\n\u251C\u2500\u2500 src/                     # \u6E90\u4EE3\u7801\u7EC4\u4EF6\n\u251C\u2500\u2500 boards/                  # \u677F\u7EA7\u652F\u6301\u5305\n\u2514\u2500\u2500 [project]/              # \u7528\u6237\u9879\u76EE\u76EE\u5F55\n    \u251C\u2500\u2500 CMakeLists.txt      # \u9879\u76EE CMake \u6587\u4EF6\n    \u251C\u2500\u2500 app_default.config  # \u9ED8\u8BA4\u914D\u7F6E\n    \u2514\u2500\u2500 .build/             # \u6784\u5EFA\u8F93\u51FA\u76EE\u5F55\n        \u251C\u2500\u2500 bin/            # \u4E8C\u8FDB\u5236\u6587\u4EF6\n        \u251C\u2500\u2500 lib/            # \u5E93\u6587\u4EF6\n        \u2514\u2500\u2500 cache/          # \u914D\u7F6E\u7F13\u5B58\n"})}),"\n",(0,c.jsx)(n.h3,{id:"5-\u7F16\u8BD1\u8F93\u51FA",children:"5. \u7F16\u8BD1\u8F93\u51FA"}),"\n",(0,c.jsx)(n.p,{children:"\u6210\u529F\u7F16\u8BD1\u540E\uFF0C\u4F1A\u5728\u4EE5\u4E0B\u4F4D\u7F6E\u751F\u6210\u6587\u4EF6\uFF1A"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u4E8C\u8FDB\u5236\u6587\u4EF6"}),": ",(0,c.jsx)(n.code,{children:".build/bin/{app_name}_QIO_{version}.bin"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u5E93\u6587\u4EF6"}),": ",(0,c.jsx)(n.code,{children:".build/lib/"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u6784\u5EFA\u53C2\u6570"}),": ",(0,c.jsx)(n.code,{children:".build/build/build_param"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u8F93\u51FA\u4FE1\u606F\u793A\u4F8B\uFF1A"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"====================[ BUILD SUCCESS ]===================\n Target    : example_QIO_1.0.0.bin\n Output    : /path/to/project/.build/bin\n Platform  : T2\n Chip      : T2-U\n Board     : t2_evb\n Framework : base\n========================================================\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u603B\u7ED3",children:"\u603B\u7ED3"}),"\n",(0,c.jsx)(n.p,{children:"TuyaOpen \u7684\u7F16\u8BD1\u7CFB\u7EDF\u901A\u8FC7 Python \u811A\u672C\u534F\u8C03 CMake/Ninja \u6784\u5EFA\u5DE5\u5177\uFF0C\u5B9E\u73B0\u4E86\uFF1A"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u591A\u5E73\u53F0\u652F\u6301"}),": \u901A\u8FC7\u5E73\u53F0\u62BD\u8C61\u5C42\u652F\u6301\u4E0D\u540C\u786C\u4EF6\u5E73\u53F0"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u914D\u7F6E\u7BA1\u7406"}),": \u4F7F\u7528 Kconfig \u7CFB\u7EDF\u7BA1\u7406\u914D\u7F6E\u9009\u9879"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u6A21\u5757\u5316\u8BBE\u8BA1"}),": \u7EC4\u4EF6\u5316\u7684\u6E90\u4EE3\u7801\u7ED3\u6784"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"\u81EA\u52A8\u5316\u6784\u5EFA"}),": \u4E00\u952E\u7F16\u8BD1\uFF0C\u81EA\u52A8\u5904\u7406\u4F9D\u8D56"]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u6574\u4E2A\u6D41\u7A0B\u8BBE\u8BA1\u6E05\u6670\uFF0C\u4FBF\u4E8E\u6269\u5C55\u548C\u7EF4\u62A4\uFF0C\u9002\u5408 IoT \u8BBE\u5907\u7684\u8DE8\u5E73\u53F0\u5F00\u53D1\u3002"}),"\n",(0,c.jsx)(n.h2,{id:"faq",children:"FAQ"})]})}function t(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(h,{...e})}):h(e)}},84429:function(e,n,l){l.d(n,{R:()=>d,x:()=>r});var i=l(96540);let c={},s=i.createContext(c);function d(e){let n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);